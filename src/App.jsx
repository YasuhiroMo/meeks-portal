import { useState, useEffect, useRef, useCallback } from "react";

/* ===== å®šæ•° ===== */
const COMPANY_PASS = "meeks2025";
const ADMIN_PASS = "admin2025";
const PASS_RATE = 80;
const TEST_Q_COUNT = 30;
const TEST_PASS_LINE = Math.ceil(TEST_Q_COUNT * 0.8);

/* ===== å…±é€šã‚¹ã‚¿ã‚¤ãƒ« ===== */
const S = {
  bg: "#f0f2f5",
  card: {
    background: "#fff",
    borderRadius: 16,
    boxShadow: "0 2px 12px rgba(0,0,0,0.06)",
    overflow: "hidden",
  },
  btn: (c) => ({
    padding: "14px 24px",
    borderRadius: 12,
    border: "none",
    background: c,
    color: "#fff",
    cursor: "pointer",
    fontSize: 16,
    fontWeight: 700,
    transition: "opacity .2s",
  }),
  input: {
    width: "100%",
    padding: "14px 16px",
    borderRadius: 12,
    border: "2px solid #ddd",
    fontSize: 16,
    outline: "none",
    boxSizing: "border-box",
    transition: "border-color .2s",
  },
};
const fmt = (d) => {
  try {
    const dt = new Date(d);
    return `${dt.getMonth() + 1}/${dt.getDate()} ${dt.getHours()}:${String(dt.getMinutes()).padStart(2, "0")}`;
  } catch {
    return d;
  }
};

/* ===== Persistent Storage ===== */
const stor = {
  get: async (k, sh = true) => {
    try { return await window.storage?.get(k, sh); } catch { return null; }
  },
  set: async (k, v, sh = true) => {
    try { return await window.storage?.set(k, v, sh); } catch { return null; }
  },
  list: async (p, sh = true) => {
    try { return await window.storage?.list(p, sh); } catch { return { keys: [] }; }
  },
  del: async (k, sh = true) => {
    try { return await window.storage?.delete(k, sh); } catch { return null; }
  },
};

/* ===== æ‰‹é †æ›¸ãƒ‡ãƒ¼ã‚¿ï¼ˆå…¨13ä»¶ï¼‰ ===== */
const MANUALS = [
  {
    id: "delivery", title: "ç´å…¥æ™‚ä½œæ¥­æ‰‹é †æ›¸", icon: "ğŸ“‹",
    tag: "2025å¹´åº¦ç‰ˆ ä¿®æ­£ç‰ˆ", color: "#1B4F72",
    sections: [
      { title: "å‡ºç™ºå‰5ç‚¹ç¢ºèª", content: "ã€å‡ºç™ºå‰ç‚¹æ¤œäº‹é …ã€‘æŒ‡å·®ã—å‘¼ç§°ã§ç¢ºèª\n\nNo.1 ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´ç¢ºèª â€” æ•·æ¿ã¯å›åã•ã‚Œã¦ã„ã‚‹ã‹ã€ãƒ­ãƒƒã‚¯ã¯ã•ã‚Œã¦ã„ã‚‹ã‹ã€‚\nNo.2 ãƒ–ãƒ¼ãƒ æ ¼ç´ç¢ºèª â€” ãƒ¯ã‚¤ãƒ¤ãƒ¼ã®ä¹±å·»ã¯ãªã„ã‹ã€æ­£ã—ãæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‹ã€‚\nNo.3 è£½å“è·ç· ã‚ç¢ºèª â€” è½ä¸‹ã€è·å´©ã‚Œã®å¯èƒ½æ€§ã¯ãªã„ã‹ã€‚\nNo.4 éƒ¨æè·ç· ã‚ç¢ºèª â€” èµ°è¡Œä¸­ã«é£›ã°ã•ã‚Œã‚‹å¯èƒ½æ€§ã¯ãªã„ã‹ã€‚\nNo.5 ä¸å…·åˆç®‡æ‰€ã®ä¿®æ­£ â€” ä¸å…·åˆã‚’èªè­˜ã—ãŸã¾ã¾ã®å‡ºç™ºã¯ç¦æ­¢ã€‚" },
      { title: "ä½œæ¥­æ‰‹é † No.1ã€œ6", content: "No.1ã€å‡ºç™ºå‰ç‚¹æ¤œã€‘5ç‚¹ç¢ºèªã‚’å®Ÿæ–½ã€‚ä¸å…·åˆã®ã‚ã‚‹çŠ¶æ…‹ã§å‡ºç™ºã—ãªã„ã€‚\nNo.2ã€ç¾å ´åˆ°ç€ã€‘ç¾å ´å‰ã«åœè»Šã€‚ç›£ç£ãƒ»æ¥­è€…æ§˜ã«é›»è©±é€£çµ¡ã€‚8:00æŒ‡å®šã¯30åˆ†ä»¥ä¸Šå‰ã®é€²å…¥ç¦æ­¢ã€‚\nNo.3ã€è·é™ã‚ã—ä½ç½®ç¢ºèªã€‘æŒ‡ç¤ºå†…å®¹ã¨ä¹–é›¢ãŒãªã„ã‹ç¢ºèªã€‚å±é™ºãŒã‚ã‚‹å ´åˆã¯ç›¸è«‡ã€‚\nNo.4ã€è»Šä¸¡ã‚’åœè»Šä½ç½®ã«ç§»å‹•ã€‘æ¡ãƒ»æ°´é“ãƒ»éšœå®³ç‰©ã‚’æŠŠæ¡ã€‚ã‚¹ã‚¿ãƒƒã‚¯å¯èƒ½æ€§ã‚ã‚Œã°å—æ³¨èª²ã«é€£çµ¡ã€‚\nNo.5ã€ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼è¨­ç½®ã€‘åœ°ç›¤ç¢ºèªãƒ»æ•·æ¿è¨­ç½®ãƒ»æœ€å¤§ä½ç½®ã¾ã§å¼µå‡ºã—ã€‚Uå­—æºè“‹ä¸Šã¸ã®è¨­ç½®ç¦æ­¢ã€‚\nNo.6ã€è·è§£ãã€‘è·å´©ã‚Œç¢ºèªå¾Œã€è¶³å…ƒã®å®‰å…¨ã‚’ç¢ºä¿ã€‚" },
      { title: "ä½œæ¥­æ‰‹é † No.7ã€œ12", content: "No.7ã€è·é™ã‚ã—é–‹å§‹ã€‘é ­ä¸Šç¢ºèªï¼ˆé›»ç·šãƒ»é›»è©±ç·šï¼‰å¿…é ˆã€‚æ–œã‚åŠã‚Šç¦æ­¢ã€‚é¢¨é€Ÿ10m/sä»¥ä¸Šã¯ä½œæ¥­ä¸­æ­¢ã€‚\nNo.8ã€è·é™ã‚ã—çµ‚äº†ã€‘è£½å“é¤Šç”Ÿãƒ»ç´å“å†™çœŸæ’®å½±ãƒ»æ˜ç´°æ›¸ã«ã‚µã‚¤ãƒ³å—é ˜ã€‚\nNo.9ã€ã‚¸ãƒ–ãƒ»ãƒ–ãƒ¼ãƒ æ ¼ç´ã€‘é ­ä¸Šç¢ºèªã—ãªãŒã‚‰æ ¼ç´ã€‚æ€¥æ—‹å›ç¦æ­¢ã€‚\nNo.10ã€ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´ã€‘å·¦å³æ ¼ç´ãƒ»æ•·æ¿æ ¼ç´ãƒ»PTOè§£é™¤ã€‚é€€å‡ºå‰5ç‚¹ç¢ºèªã‚’å®Ÿæ–½ã€‚\nNo.11ã€è·ç· ã‚ãƒ»å‡ºç™ºæº–å‚™ã€‘è·å°è·ç· ã‚ãƒ»å‡ºç™ºå‰å†™çœŸæ’®å½±ã€‚\nNo.12ã€å¸°åº«ã€‘è·å°ç¢ºèªãƒ»æ•´ç†ãƒ»ç›—é›£é˜²æ­¢è£…ç½®ä½œå‹•ãƒ»ãƒãƒ³ãƒ‰ãƒ«ãƒ­ãƒƒã‚¯ã€‚" },
      { title: "é€€å‡ºå‰5ç‚¹ç¢ºèª", content: "â‘ ãƒ–ãƒ¼ãƒ æ ¼ç´ â€” ç¸®å°ãƒ»æ—‹å›ãƒ»å®šä½ç½®ã«æ ¼ç´æ¸ˆã¿\nâ‘¡ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´ â€” å·¦å³æ ¼ç´ãƒ»æ•·æ¿å›åãƒ»ãƒ­ãƒƒã‚¯ç¢ºèª\nâ‘¢ãƒ¯ã‚¤ãƒ¤ãƒ¼ä¹±å·»ãªã— â€” ç¢ºèªæ¸ˆã¿\nâ‘£ãƒ•ãƒƒã‚¯æ ¼ç´ â€” æ ¼ç´ä½ç½®ã«å›ºå®šæ¸ˆã¿\nâ‘¤PTOè§£é™¤ â€” è§£é™¤æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª\n\nå‘¼ç§°ï¼šã€Œãƒ–ãƒ¼ãƒ æ ¼ç´ã‚ˆã—ï¼ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´ã‚ˆã—ï¼ãƒ¯ã‚¤ãƒ¤ãƒ¼ä¹±å·»ãªã—ã‚ˆã—ï¼ãƒ•ãƒƒã‚¯æ ¼ç´ã‚ˆã—ï¼PTOè§£é™¤ã‚ˆã—ï¼ã€" },
    ],
  },
  {
    id: "accident", title: "äº‹æ•…å¯¾å¿œæ‰‹é †æ›¸", icon: "ğŸš¨",
    tag: "2025å¹´åº¦ç‰ˆ ä¿®æ­£ç‰ˆ", color: "#C0392B",
    sections: [
      { title: "äº‹æ•…ç™ºç”Ÿæ™‚ã®3åŸå‰‡", content: "â‘  å®‰å…¨ç¢ºä¿ï¼ˆäºŒæ¬¡ç½å®³ã®é˜²æ­¢ï¼‰\nâ‘¡ æ•‘è­·ãƒ»é€šå ±ï¼ˆ119ç•ªãƒ»110ç•ªï¼‰\nâ‘¢ ä¼šç¤¾é€£çµ¡ï¼ˆé…è»Šæ‹…å½“ï¼š090-1213-9803ï¼‰\n\nã€çµ¶å¯¾ç¦æ­¢äº‹é …ã€‘\nãƒ»ç¾å ´ã‹ã‚‰ã®é›¢è„±\nãƒ»äº‹æ•…å ±å‘Šã®éš è”½\nãƒ»ç¤ºè«‡äº¤æ¸‰\nãƒ»ã€Œç§ãŒæ‚ªã„ã€ç­‰ã®è²¬ä»»ã‚’èªã‚ã‚‹ç™ºè¨€\nãƒ»SNSã¸ã®æŠ•ç¨¿" },
      { title: "é›»ç·šåˆ‡æ–­æ™‚ã®å¯¾å¿œ", content: "1. çµ¶å¯¾ã«è»Šä¸¡ã‹ã‚‰é™ã‚Šãªã„ï¼ˆæ„Ÿé›»ã®å±é™ºï¼‰\n2. 110ç•ªã«é€£çµ¡\n3. é…è»Šæ‹…å½“ã«é€£çµ¡ï¼ˆ090-1213-9803ï¼‰\n4. æ±äº¬é›»åŠ›ã«é€£çµ¡ï¼ˆ0120-995-007ï¼‰\n5. æ•‘æ€¥ãƒ»è­¦å¯Ÿã®åˆ°ç€ã¾ã§è»Šå†…ã§å¾…æ©Ÿ" },
      { title: "ç·Šæ€¥é€£çµ¡å…ˆä¸€è¦§", content: "è­¦å¯Ÿï¼š110ï¼ˆ24æ™‚é–“ï¼‰\næ•‘æ€¥ãƒ»æ¶ˆé˜²ï¼š119ï¼ˆ24æ™‚é–“ï¼‰\né…è»Šæ‹…å½“è€…ï¼š090-1213-9803ï¼ˆæ¥­å‹™æ™‚é–“å†…ï¼‰\nèŒ¨åŸå·¥å ´å—æ³¨èª²ï¼š090-6301-8209ï¼ˆ8:00ã€œ17:00ï¼‰\nãƒ¡ãƒ¼ã‚¯ã‚¹æœ¬ç¤¾ï¼š0297-55-1380\næ™‚é–“å¤–ï¼š0297-55-1380ï¼ˆ17:00ã€œç¿Œ8:00ãƒ»åœŸæ—¥ç¥ï¼‰\næ±äº¬é›»åŠ›ï¼š0120-995-007\nNTTï¼š0120-444-113" },
    ],
  },
  {
    id: "checklist", title: "ãƒŸã‚¹é˜²æ­¢ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆé›†", icon: "âœ…",
    tag: "2025å¹´åº¦ç‰ˆ ä¿®æ­£ç‰ˆ", color: "#1E8449",
    sections: [
      { title: "å‡ºç™ºå‰ãƒã‚§ãƒƒã‚¯", content: "â–¡ é…è»Šè¡¨ã®æ—¥ä»˜ãƒ»é…é€å…ˆãƒ»æ™‚é–“æŒ‡å®šã‚’ç¢ºèª\nâ–¡ è¢‹è©°ã‚ï¼ˆä¼ç¥¨ï¼‰ã¨é…è»Šè¡¨ã‚’ç…§åˆ\nâ–¡ è£½å“ã¨æ˜ç´°è¡¨ã®æ•°é‡ãƒ»å“ç•ªã‚’ç¢ºèª\nâ–¡ è·ç· ã‚ãƒ»é¤Šç”Ÿã‚’ç¢ºèª\nâ–¡ å‡ºç™ºå‰5ç‚¹ç¢ºèªã‚’å®Ÿæ–½" },
      { title: "ç¾å ´åˆ°ç€ã€œç´å“", content: "â–¡ é…è»Šè¡¨ã®ä½æ‰€ã¨åˆ°ç€ã—ãŸç¾å ´ãŒä¸€è‡´\nâ–¡ ç›£ç£ãƒ»æ¥­è€…æ§˜ã«æŒ¨æ‹¶ã—ç´å“å ´æ‰€ã‚’ç¢ºèª\nâ–¡ é ­ä¸Šã®é›»ç·šä½ç½®ã‚’ç¢ºèª\nâ–¡ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æœ€å¤§å¼µå‡ºã—ãƒ»æ•·æ¿è¨­ç½®\nâ–¡ æ˜ç´°æ›¸ã«ã‚µã‚¤ãƒ³å—é ˜\nâ–¡ ç´å“å†™çœŸã‚’æ’®å½±" },
      { title: "é€€å‡ºå‰ãƒã‚§ãƒƒã‚¯", content: "â–¡ ãƒ–ãƒ¼ãƒ æ ¼ç´\nâ–¡ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´\nâ–¡ ãƒ•ãƒƒã‚¯æ ¼ç´\nâ–¡ ãƒ¯ã‚¤ãƒ¤ãƒ¼ä¹±å·»ãªã—\nâ–¡ PTOè§£é™¤\nâ–¡ æ•·æ¿ãƒ»ç‰æ›ã‘ç”¨å…·ã‚’ç©ã¿æˆ»ã—\nâ–¡ å¿˜ã‚Œç‰©ãªã—\nâ–¡ ç¾å ´ã‚’æ±šã—ã¦ã„ãªã„ã‹ç¢ºèª" },
    ],
  },
  {
    id: "health", title: "å¥åº·ç®¡ç†ãƒ»å­£ç¯€åˆ¥å¯¾ç­–", icon: "ğŸ’ª",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#2E86C1",
    sections: [
      { title: "åŸºæœ¬ã®å¥åº·ç®¡ç†", content: "ã€ç¡çœ ã€‘1æ—¥7æ™‚é–“ä»¥ä¸Šã€‚SASï¼ˆç¡çœ æ™‚ç„¡å‘¼å¸ç—‡å€™ç¾¤ï¼‰ã®è‡ªè¦šãŒã‚ã‚Œã°åŒ»å¸«ã«ç›¸è«‡ã€‚\nã€é£²é…’ã€‘ãƒ“ãƒ¼ãƒ«ä¸­ç“¶1æœ¬ï¼åˆ†è§£ã«ç´„3ã€œ4æ™‚é–“ã€‚3æœ¬ï¼ç´„9ã€œ12æ™‚é–“ã€‚\nã€é£Ÿäº‹ã€‘æœé£Ÿå¿…é ˆï¼ˆè¡€ç³–å€¤ä½ä¸‹é˜²æ­¢ï¼‰ã€‚æ˜¼é£Ÿã¯è…¹å…«åˆ†ç›®ï¼ˆæº€è…¹ã¯çœ æ°—èª˜ç™ºï¼‰ã€‚\nã€æŒç—…ãƒ»æœè–¬ã€‘çœ æ°—ã®å‰¯ä½œç”¨ãŒã‚ã‚‹è–¬ã¯ä¼šç¤¾ã«ç”³å‘Šã€‚è‡ªå·±åˆ¤æ–­ã®æœè–¬ä¸­æ­¢ã¯ç¦æ­¢ã€‚" },
      { title: "å­£ç¯€åˆ¥å¯¾ç­–", content: "ã€ç†±ä¸­ç—‡äºˆé˜²ã€‘WBGT31ä»¥ä¸Šã¯åŸå‰‡å¤–ä½œæ¥­ä¸­æ­¢ã€‚1æ™‚é–“ã«ã‚³ãƒƒãƒ—2ã€œ3æ¯ã®æ°´åˆ†è£œçµ¦ã€‚\nè»½åº¦ï¼ˆã‚ã¾ã„ï¼‰â†’æ¶¼ã—ã„å ´æ‰€ã§æ°´åˆ†è£œçµ¦ã€‚é‡åº¦ï¼ˆæ„è­˜éšœå®³ï¼‰â†’119ç•ªã€‚\n\nã€å†¬å­£å¯¾ç­–ã€‘ã‚¹ã‚¿ãƒƒãƒ‰ãƒ¬ã‚¹ã‚¿ã‚¤ãƒ¤12æœˆã€œ3æœˆå¿…é ˆã€‚å‡çµæ³¨æ„ï¼šæ©‹ã®ä¸Šãƒ»ãƒˆãƒ³ãƒãƒ«å‡ºå…¥å£ãƒ»æ—¥é™°ã€‚\n\nã€å°é¢¨æ™‚ã€‘æš´é¢¨åŸŸäºˆæƒ³â†’é‹è¡Œä¸­æ­¢ã€‚é¢¨é€Ÿ15m/sä»¥ä¸Šâ†’èµ°è¡Œå±é™ºã€‚å† æ°´é“è·¯é€²å…¥ç¦æ­¢ã€‚\n\nã€èŠ±ç²‰ç—‡ã€‘ä¸»æ²»åŒ»ã«ã€Œé‹è»¢æ¥­å‹™ã€ã‚’ä¼ãˆçœ æ°—ã®å°‘ãªã„è–¬ã‚’å‡¦æ–¹ã€‚å¸‚è²©è–¬ã®è‡ªå·±åˆ¤æ–­ä½¿ç”¨ã¯å±é™ºã€‚" },
    ],
  },
  {
    id: "driving", title: "èµ°è¡Œä¸­ã®å®‰å…¨", icon: "ğŸš›",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#6C3483",
    sections: [
      { title: "é€Ÿåº¦ãƒ»é‹è»¢ãƒ«ãƒ¼ãƒ«", content: "ã€é€Ÿåº¦åˆ¶é™ã€‘ä½å®…è¡—20km/hä»¥ä¸‹ã€‚ä¸€èˆ¬é“ã¯æ³•å®šé€Ÿåº¦å³å®ˆã€‚\nã€ãªãŒã‚‰é‹è»¢ã€‘å³ç¦ã€‚ã‚¹ãƒãƒ›æ“ä½œã¯å¿…ãšå®‰å…¨ãªå ´æ‰€ã«åœè»Šã—ã¦ã‹ã‚‰ã€‚\nã€ã‚ãŠã‚Šé‹è»¢ã€‘æŒ‘ç™ºã«ä¹—ã‚‰ãšå®‰å…¨ãªå ´æ‰€ã«ç§»å‹•â†’110ç•ªã€‚\nã€é«˜é€Ÿé“è·¯æ•…éšœæ™‚ã€‘ãƒã‚¶ãƒ¼ãƒ‰â†’è·¯è‚©åœè»Šâ†’ä¸‰è§’è¡¨ç¤ºæ¿â†’è»Šå¤–é¿é›£ï¼ˆã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«å¤–ã¸ï¼‰ã€‚" },
      { title: "æ”¹å–„åŸºæº–å‘Šç¤º", content: "ã€æ‹˜æŸæ™‚é–“ã€‘1æ—¥ï¼šåŸå‰‡13æ™‚é–“ä»¥å†…ï¼ˆä¸Šé™16æ™‚é–“ï¼‰ã€‚1ã‹æœˆï¼šåŸå‰‡284æ™‚é–“ã€‚\nã€é€£ç¶šé‹è»¢ã€‘4æ™‚é–“ä»¥å†…ã«30åˆ†ä»¥ä¸Šä¼‘æ†©ã€‚\nã€å‹¤å‹™é–“ä¼‘æ¯ã€‘ç¶™ç¶š11æ™‚é–“ä»¥ä¸ŠãŒåŸºæœ¬ã€‚" },
    ],
  },
  {
    id: "kyt", title: "å±é™ºäºˆçŸ¥ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆKYTï¼‰", icon: "âš ï¸",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#D4AC0D",
    sections: [
      { title: "KYT 4ãƒ©ã‚¦ãƒ³ãƒ‰æ³•", content: "ç¬¬1Rï¼šå±é™ºã®æ´—ã„å‡ºã—ï¼ˆã©ã‚“ãªå±é™ºãŒã‚ã‚‹ã‹ï¼‰\nç¬¬2Rï¼šå±é™ºã®çµã‚Šè¾¼ã¿ï¼ˆæœ€ã‚‚é‡è¦ãªå±é™ºã¯ï¼‰\nç¬¬3Rï¼šå¯¾ç­–ã®ç«‹æ¡ˆï¼ˆã‚ãªãŸãªã‚‰ã©ã†ã™ã‚‹ï¼‰\nç¬¬4Rï¼šè¡Œå‹•ç›®æ¨™ã®è¨­å®šï¼ˆæŒ‡å·®ã—å‘¼ç§°é …ç›®ã‚’æ±ºå®šï¼‰" },
      { title: "KYTã‚·ãƒŠãƒªã‚ªé›†", content: "ã€KYT-1ï¼šä½å®…è¡—ã§ã®ãƒãƒƒã‚¯èµ°è¡Œã€‘\nå ´é¢ï¼šä½å®…è¡—ã®ç‹­ã„é“è·¯ã€é›»æŸ±ã‚ã‚Šã€å·¦ã«ä¹—ç”¨è»Šã€å³ã«æ°‘å®¶ãƒ–ãƒ­ãƒƒã‚¯å¡€ã€‚\nå±é™ºï¼šâ‘ å·¦è»Šä¸¡ã¨æ¥è§¦ â‘¡å³ãƒ–ãƒ­ãƒƒã‚¯å¡€ã«ã‚ªãƒ¼ãƒãƒ¼ãƒãƒ³ã‚°æ¥è§¦â— â‘¢æ­©è¡Œè€…ã®é£›ã³å‡ºã—â—\nå¯¾ç­–ï¼šé™è»Šã—ã¦å¾Œæ–¹ç¢ºèªã€èª˜å°è€…é…ç½®\n\nã€KYT-2ï¼šé›¨å¤©æ™‚ã®è·é™ã‚ã—ã€‘\nå ´é¢ï¼šå°é›¨ã€ç¾å ´ã®åœ°é¢ã¯ã¬ã‹ã‚‹ã¿ã€ã‚¹ãƒ­ãƒ¼ãƒ—ã‚ã‚Šã€‚\nå±é™ºï¼šâ‘ ã‚¹ãƒªãƒƒãƒ—ã—ã¦è»¢å€’â— â‘¡ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ²ˆä¸‹â— â‘¢è£½å“æ°´æ¿¡ã‚Œ\nå¯¾ç­–ï¼šæ•·æ¿ã‚’å¤šã‚ã«ä½¿ç”¨ã€è¶³å…ƒç¢ºèª\n\nã€KYT-3ï¼šé›»ç·šä¸‹ã§ã®ã‚¯ãƒ¬ãƒ¼ãƒ³ä½œæ¥­ã€‘\nå ´é¢ï¼šè·é™ã‚ã—ä½ç½®ã®çœŸä¸Šã«é›»ç·šã€é«˜ã•ç´„6mã€‚\nå±é™ºï¼šâ‘ ãƒ–ãƒ¼ãƒ ãƒ»ãƒ¯ã‚¤ãƒ¤ãƒ¼ãŒé›»ç·šã«æ¥è§¦â— â‘¡æ„Ÿé›»\nå¯¾ç­–ï¼šé›»ç·šä½ç½®ã‚’ç¢ºèªã—å®‰å…¨ãªè·é›¢ã‚’ç¢ºä¿ã€è»Šä¸¡ä½ç½®ã‚’å¤‰æ›´" },
    ],
  },
  {
    id: "crane", title: "ã‚¯ãƒ¬ãƒ¼ãƒ³æ“ä½œå®‰å…¨æ‰‹é †", icon: "ğŸ—ï¸",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#A04000",
    sections: [
      { title: "æ“ä½œå‰ç¢ºèª", content: "â–¡ å°å‹ç§»å‹•å¼ã‚¯ãƒ¬ãƒ¼ãƒ³é‹è»¢æŠ€èƒ½è¬›ç¿’ä¿®äº†è¨¼ã®æºå¸¯\nâ–¡ ã‚¯ãƒ¬ãƒ¼ãƒ³å„éƒ¨ã®å…¥å¿µãªç‚¹æ¤œ\nâ–¡ éè² è·é˜²æ­¢è£…ç½®ãƒ»å·»éé˜²æ­¢è£…ç½®ã®æ©Ÿèƒ½ç¢ºèª\nâ–¡ å®šæ ¼è·é‡ã‚’è¶…ãˆã‚‹è·ç‰©ã¯åŠã‚Šä¸Šã’ãªã„\nâ–¡ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã‚’æœ€å¤§ä½ç½®ã¾ã§å¼µã‚Šå‡ºã—ï¼ˆç‰‡å´ã®ã¿ç¦æ­¢ï¼‰\nâ–¡ æ•·æ¿ã‚’å¿…ãšè¨­ç½®" },
      { title: "æ“ä½œä¸­ã®æ³¨æ„", content: "ãƒ»åŠã‚Šè·ã®ä¸‹ã«äººã‚’ç«‹ã¡å…¥ã‚‰ã›ãªã„\nãƒ»æ€¥æ¿€ãªæ“ä½œã‚’é¿ã‘è·æŒ¯ã‚Œã‚’æœ€å°é™ã«\nãƒ»ç§»å‹•ã—ãªãŒã‚‰ã®æ“ä½œç¦æ­¢\nãƒ»è¤‡æ•°ãƒ¬ãƒãƒ¼ã®åŒæ™‚æ“ä½œç¦æ­¢\nãƒ»æ—‹å›æ™‚ã¯é ­ä¸Šç¢ºèªï¼ˆé›»ç·šãƒ»é›»è©±ç·šï¼‰\nãƒ»é¢¨é€Ÿ10m/sä»¥ä¸Šã¯ä½œæ¥­ä¸­æ­¢" },
    ],
  },
  {
    id: "loading", title: "ç©è¾¼ãƒ»é¤Šç”Ÿæ‰‹é †", icon: "ğŸ“¦",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#1A5276",
    sections: [
      { title: "ç©è¾¼ã®åŸºæœ¬", content: "ãƒ»é…é€é †ç•ªã‚’è€ƒæ…®ã—ãŸç©è¾¼ï¼ˆå…ˆã«é™ã‚ã™ã‚‚ã®ã‚’å¤–å´ã«ï¼‰\nãƒ»é‡å¿ƒã‚’ä½ãã€åã‚Šã®ãªã„ã‚ˆã†ã«ç©è¼‰\nãƒ»è·ç· ã‚ã¯ãƒ©ãƒƒã‚·ãƒ³ã‚°ãƒ™ãƒ«ãƒˆæœ€ä½2æœ¬ä»¥ä¸Š\nãƒ»è£½å“é–“ã«å½“ã¦ç‰©ï¼ˆè§’å½“ã¦ï¼‰ã‚’å…¥ã‚Œã‚‹\nãƒ»ãƒ¡ãƒ¼ã‚«ãƒ¼æ¯ã®é¤Šç”Ÿã‚·ãƒ¼ãƒˆæº–å‚™\nãƒ»å¾Œéƒ¨ã¯ã¿å‡ºã—éƒ¨ã«èµ¤ã„å¸ƒã‚’å–ã‚Šä»˜ã‘" },
    ],
  },
  {
    id: "site_manner", title: "ç¾å ´ãƒãƒŠãƒ¼", icon: "ğŸ ",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#117A65",
    sections: [
      { title: "ç¾å ´ã§ã®ãƒ«ãƒ¼ãƒ«", content: "ãƒ»é£ã‚Šæ–¹ï¼ˆã‚„ã‚Šã‹ãŸï¼‰ãƒ»æ°´ç³¸ãƒ»é¥…é ­ã‚’çµ¶å¯¾ã«ç ´æã—ãªã„\nãƒ»åœ°ç¸„ã®å†…å´ã«è£½å“ã‚’ç½®ã‹ãªã„\nãƒ»é˜²æ¹¿ã‚·ãƒ¼ãƒˆã‚’æ±šã•ãªã„ãƒ»ç ´æã—ãªã„\nãƒ»è¿‘éš£ä½å®…ã®å¡€ãƒ»è»Šä¸¡ãƒ»æ¤æ ½ã«æ³¨æ„\nãƒ»ç¾å ´ã‚’æ±šã—ãŸå ´åˆã¯å¿…ãšæ¸…æƒ\nãƒ»ã‚´ãƒŸã®ãƒã‚¤æ¨ã¦å³ç¦" },
    ],
  },
  {
    id: "law12", title: "æ³•å®š12é …ç›®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼æ•™è‚²è³‡æ–™", icon: "ğŸ“š",
    tag: "å›½åœŸäº¤é€šçœå‘Šç¤ºæº–æ‹ ", color: "#34495E",
    sections: [
      { title: "ç¬¬1é …ã€œç¬¬3é …", content: "ã€ç¬¬1é …ï¼šäº‹æ¥­ç”¨è‡ªå‹•è»Šã®å¿ƒæ§‹ãˆã€‘\nå®‰å…¨æœ€å„ªå…ˆã€‚æ€¥ã„ã§ã„ã¦ã‚‚é€Ÿåº¦è¶…éã‚„ç¢ºèªçœç•¥ã‚’ã—ãªã„ã€‚\n\nã€ç¬¬2é …ï¼šé‹è¡Œã®å®‰å…¨ç¢ºä¿ã€‘\næ—¥å¸¸ç‚¹æ¤œãƒ»ç‚¹å‘¼ãƒ»ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯ï¼ˆ0.00mg/Lï¼‰ãƒ»é‹è»¢æ—¥å ±æå‡ºã€‚\n\nã€ç¬¬3é …ï¼šè»Šä¸¡ã®æ§‹é€ ä¸Šã®ç‰¹æ€§ã€‘\nãƒˆãƒ©ãƒƒã‚¯ã¯å†…è¼ªå·®ãŒå¤§ããã€ã‚ªãƒ¼ãƒãƒ¼ãƒãƒ³ã‚°ã‚ã‚Šã€‚åˆ¶å‹•è·é›¢ãŒé•·ã„ã€‚æ­»è§’ãŒå¤šã„ã€‚" },
      { title: "ç¬¬4é …ã€œç¬¬6é …", content: "ã€ç¬¬4é …ï¼šæ­£ã—ã„ç©è¼‰æ–¹æ³•ã€‘\né‡å¿ƒã‚’ä½ãåã‚Šãªãã€‚ãƒ©ãƒƒã‚·ãƒ³ã‚°ãƒ™ãƒ«ãƒˆ2æœ¬ä»¥ä¸Šã€‚ã¯ã¿å‡ºã—éƒ¨ã«èµ¤ã„å¸ƒã€‚\n\nã€ç¬¬5é …ï¼šéç©è¼‰ã®å±é™ºæ€§ã€‘\nåˆ¶å‹•è·é›¢å¢—å¤§ãƒ»æ¨ªè»¢ãƒªã‚¹ã‚¯ãƒ»è¡Œæ”¿å‡¦åˆ†ã®å¯¾è±¡ã€‚\n\nã€ç¬¬6é …ï¼šå±é™ºç‰©é‹æ¬ã®ç•™æ„äº‹é …ã€‘\né€šå¸¸æ¥­å‹™ã§ã¯å±é™ºç‰©é‹æ¬ãªã—ã€‚äº‹æ•…é­é‡æ™‚ã¯å®‰å…¨ãªè·é›¢ã‚’ã¨ã‚Šé¢¨ä¸Šã«ç§»å‹•ã€‚" },
      { title: "ç¬¬7é …ã€œç¬¬12é …", content: "ã€ç¬¬7é …ï¼šé©åˆ‡ãªé‹è¡ŒçµŒè·¯ã€‘é«˜ã•ãƒ»é‡é‡åˆ¶é™ã‚’ç¢ºèªã€‚ç‹­ã„é“è·¯ã«ã¯ç„¡ç†ã«é€²å…¥ã—ãªã„ã€‚\nã€ç¬¬8é …ï¼šå±é™ºäºˆæ¸¬ãƒ»ç·Šæ€¥æ™‚å¯¾å¿œã€‘KYTæ•™æãƒ»äº‹æ•…å¯¾å¿œæ‰‹é †æ›¸ã‚’å‚ç…§ã€‚\nã€ç¬¬9é …ï¼šé‹è»¢é©æ€§ã«å¿œã˜ãŸå®‰å…¨é‹è»¢ã€‘é©æ€§è¨ºæ–­ã§ç‰¹æ€§ã‚’æŠŠæ¡ã€‚\nã€ç¬¬10é …ï¼šç”Ÿç†çš„ãƒ»å¿ƒç†çš„è¦å› ã€‘éåŠ´é‹è»¢ç¦æ­¢ã€‚ã€Œã ã‚ã†ã€â†’ã€Œã‹ã‚‚ã—ã‚Œãªã„ã€é‹è»¢ã€‚\nã€ç¬¬11é …ï¼šå¥åº·ç®¡ç†ã€‘ç¡çœ 7hä»¥ä¸Šã€‚é£²é…’å¾Œã®é‹è»¢å³ç¦ã€‚\nã€ç¬¬12é …ï¼šå®‰å…¨è£…ç½®ã€‘ãƒãƒƒã‚¯ã‚«ãƒ¡ãƒ©ç­‰ã¯è£œåŠ©ã€‚å¿…ãšç›®è¦–ç¢ºèªã‚’ä½µç”¨ã€‚" },
    ],
  },
  {
    id: "driver_edu", title: "ãƒ‰ãƒ©ã‚¤ãƒãƒ¼æ•™è‚²ãƒã‚§ãƒƒã‚¯è¡¨", icon: "ğŸ“",
    tag: "2025å¹´åº¦ç‰ˆ", color: "#6C3483",
    sections: [
      { title: "èº«ã ã—ãªã¿ãƒ»ãƒãƒŠãƒ¼", content: "â–¡ ä½œæ¥­æœã¯æ¸…æ½”ãªã‚‚ã®ã‚’ç€ç”¨\nâ–¡ ãƒ˜ãƒ«ãƒ¡ãƒƒãƒˆç€ç”¨ã€ã‚ã”ç´ç¢ºå®Ÿã«ç· ã‚ã‚‹\nâ–¡ å®‰å…¨é´ç€ç”¨ãƒ»ä¿è­·æ‰‹è¢‹ç€ç”¨\nâ–¡ ãŠå®¢æ§˜ãƒ»è¿‘éš£ä½æ°‘ã¸ã®ç©æ¥µçš„ãªæŒ¨æ‹¶\nâ–¡ ä¸å¯§ãªè¨€è‘‰é£ã„\nâ–¡ æ™‚é–“æŒ‡å®šã®å³å®ˆ\nâ–¡ ç¾å ´ãƒ»ç¾å ´ä»˜è¿‘ã¯ç¦ç…™" },
      { title: "ã‚¯ãƒ¬ãƒ¼ãƒ³ãƒ»æ›¸é¡ãƒ»ç©è¾¼", content: "â–¡ ä¿®äº†è¨¼ã®æºå¸¯\nâ–¡ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æœ€å¤§å¼µã‚Šå‡ºã—ãƒ»ç‰‡å´ç¦æ­¢\nâ–¡ é¢¨é€Ÿ10m/sä»¥ä¸Šã¯ä½œæ¥­ä¸­æ­¢\nâ–¡ é…è»Šè¡¨ãƒ»æ˜ç´°è¡¨ã®ç¢ºèª\nâ–¡ é…é€é †ã‚’è€ƒæ…®ã—ãŸç©è¾¼\nâ–¡ è·ç· ã‚ãƒ»é¤Šç”Ÿã®å¾¹åº•" },
      { title: "ç¾å ´ä½œæ¥­ãƒ»ç‚¹æ¤œ", content: "â–¡ åˆ°ç€é€£çµ¡ãƒ»è·é™ã‚ã—ä½ç½®ç¢ºèª\nâ–¡ æ˜ç´°æ›¸ã«ã‚µã‚¤ãƒ³å—é ˜\nâ–¡ é€€å‡ºå‰5ç‚¹ç¢ºèª\nâ–¡ è»Šä¸¡ãƒ»ãƒ¦ãƒ‹ãƒƒã‚¯æ—¥å¸¸ç‚¹æ¤œ\nâ–¡ ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯\nâ–¡ é‹è»¢æ—¥å ±ã®è¨˜å…¥ãƒ»æå‡º" },
    ],
  },
  {
    id: "customer", title: "é¡§å®¢æº€è¶³ãƒ»ãƒãƒŠãƒ¼", icon: "ğŸ¤",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#B7950B",
    sections: [
      { title: "ãƒãƒŠãƒ¼ã®åŸºæœ¬", content: "ãƒ»ä½œæ¥­æœã¯æ¸…æ½”ãªã‚‚ã®ã‚’ç€ç”¨\nãƒ»ãƒ˜ãƒ«ãƒ¡ãƒƒãƒˆãƒ»å®‰å…¨é´ãƒ»ä¿è­·æ‰‹è¢‹ã‚’ç€ç”¨\nãƒ»ãŠå®¢æ§˜ãƒ»è¿‘éš£ä½æ°‘ã¸ç©æ¥µçš„ã«æŒ¨æ‹¶\nãƒ»ä¸å¯§ãªè¨€è‘‰é£ã„\nãƒ»æ™‚é–“æŒ‡å®šå³å®ˆï¼ˆæ—©ã™ãã¦ã‚‚NGï¼‰\nãƒ»é…ã‚Œã‚‹å ´åˆã¯äº‹å‹™æ‰€ã¸æ—©ã‚ã«å ±å‘Š\nãƒ»ç¾å ´ãƒ»ç¾å ´ä»˜è¿‘ã¯ç¦ç…™\nãƒ»ã‚´ãƒŸã®ãƒã‚¤æ¨ã¦å³ç¦\nãƒ»è»Šä¸¡ã®ç§»å‹•ã‚’è¦æ±‚ã•ã‚ŒãŸã‚‰é€Ÿã‚„ã‹ã«å¯¾å¿œ" },
    ],
  },
  {
    id: "mistakes", title: "ã‚ˆãã‚ã‚‹ãƒŸã‚¹ã¨é˜²æ­¢ç­–", icon: "ğŸ”",
    tag: "å®‰å…¨æ•™è‚²è³‡æ–™", color: "#7D3C98",
    sections: [
      { title: "ãƒŸã‚¹äº‹ä¾‹ã¨å¯¾ç­–", content: "ã€èª¤é…é€ã€‘åˆ°ç€æ™‚ã«ä½æ‰€ãƒ»ç‰©ä»¶åã‚’é…è»Šè¡¨ã¨ç…§åˆ\nã€æ•°é‡ãƒŸã‚¹ã€‘å£°ã«å‡ºã—ã¦1ã¤ãšã¤æ•°ãˆã‚‹\nã€æ˜ç´°æ›¸ç½®ãå¿˜ã‚Œã€‘é€€å‡ºå‰ã«æ›¸é¡ã®ä»•åˆ†ã‘ã‚’ç¢ºèª\nã€ã‚µã‚¤ãƒ³å¿˜ã‚Œã€‘é€€å‡ºå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã§ç¢ºèª\nã€ãƒ–ãƒ¼ãƒ æ ¼ç´å¿˜ã‚Œã€‘å‡ºç™ºå‰5ç‚¹ç¢ºèªã‚’æ¯å›å®Ÿæ–½\nã€æ•·æ¿å›åå¿˜ã‚Œã€‘é€€å‡ºå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã«å«ã‚ã‚‹\nã€è£½å“ç ´æã€‘é¤Šç”Ÿãƒ»è·ç· ã‚ã®å¾¹åº•ã€ä¸å¯§ãªæ“ä½œ" },
    ],
  },
];

/* ===== Eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã‚³ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ï¼ˆå…¨13ã‚³ãƒ¼ã‚¹ï¼‰ ===== */
const COURSES = [
  {
    id: "delivery_basic", title: "ç´å…¥åŸºæœ¬æ‰‹é †", icon: "ğŸšš", cat: "åŸºæœ¬æ¥­å‹™", color: "#1B4F72",
    secs: [{ title: "å‡ºç™ºå‰ã€œå¸°åº«ã¾ã§ã®æµã‚Œ", body: "å‡ºç™ºå‰5ç‚¹ç¢ºèªâ†’ç¾å ´åˆ°ç€â†’è·é™ã‚ã—â†’é€€å‡ºå‰5ç‚¹ç¢ºèªã®ä¸€é€£ã®æµã‚Œã‚’å­¦ã³ã¾ã™ã€‚\n\nã€å‡ºç™ºå‰5ç‚¹ç¢ºèªã€‘\nâ‘ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´ç¢ºèª\nâ‘¡ãƒ–ãƒ¼ãƒ æ ¼ç´ç¢ºèª\nâ‘¢è£½å“è·ç· ã‚ç¢ºèª\nâ‘£éƒ¨æè·ç· ã‚ç¢ºèª\nâ‘¤ä¸å…·åˆç®‡æ‰€ã®ä¿®æ­£\n\nã€é€€å‡ºå‰5ç‚¹ç¢ºèªã€‘\nâ‘ ãƒ–ãƒ¼ãƒ æ ¼ç´\nâ‘¡ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´\nâ‘¢ãƒ¯ã‚¤ãƒ¤ãƒ¼ä¹±å·»ãªã—\nâ‘£ãƒ•ãƒƒã‚¯æ ¼ç´\nâ‘¤PTOè§£é™¤" }],
    quiz: [
      { q: "å‡ºç™ºå‰5ç‚¹ç¢ºèªã«å«ã¾ã‚Œãªã„ã‚‚ã®ã¯ï¼Ÿ", o: ["ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´", "ãƒ–ãƒ¼ãƒ æ ¼ç´", "ã‚¿ã‚¤ãƒ¤ç©ºæ°—åœ§æ¸¬å®š", "è£½å“è·ç· ã‚"], a: 2 },
      { q: "8:00æŒ‡å®šã®å ´åˆã€ä½•æ™‚ã‚ˆã‚Šå‰ã®é€²å…¥ãŒç¦æ­¢ï¼Ÿ", o: ["7:00", "7:15", "7:30", "7:45"], a: 2 },
      { q: "ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã®å¼µã‚Šå‡ºã—ã¯ï¼Ÿ", o: ["åŠåˆ†ã§OK", "æœ€å¤§ä½ç½®", "çŠ¶æ³ã«å¿œã˜ã¦", "ä¸è¦ãªå ´åˆã‚ã‚Š"], a: 1 },
      { q: "é€€å‡ºå‰5ç‚¹ç¢ºèªã®æœ€åˆã®é …ç›®ã¯ï¼Ÿ", o: ["PTOè§£é™¤", "ãƒ•ãƒƒã‚¯æ ¼ç´", "ãƒ–ãƒ¼ãƒ æ ¼ç´", "ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´"], a: 2 },
      { q: "ä¸å…·åˆã‚’èªè­˜ã—ãŸå ´åˆã®å¯¾å¿œã¯ï¼Ÿ", o: ["èµ°è¡Œä¸­ã«ä¿®ç†", "ãã®ã¾ã¾å‡ºç™º", "å‡ºç™ºå‰ã«ä¿®æ­£", "å¸°ç¤¾å¾Œã«å ±å‘Š"], a: 2 },
    ],
  },
  {
    id: "accident_response", title: "äº‹æ•…å¯¾å¿œ", icon: "ğŸš¨", cat: "ç·Šæ€¥å¯¾å¿œ", color: "#C0392B",
    secs: [{ title: "äº‹æ•…ç™ºç”Ÿæ™‚ã®3åŸå‰‡ã¨ç¦æ­¢äº‹é …", body: "ã€äº‹æ•…ç™ºç”Ÿæ™‚ã®3åŸå‰‡ã€‘\nâ‘  å®‰å…¨ç¢ºä¿ï¼ˆäºŒæ¬¡ç½å®³ã®é˜²æ­¢ï¼‰\nâ‘¡ æ•‘è­·ãƒ»é€šå ±ï¼ˆ119ç•ªãƒ»110ç•ªï¼‰\nâ‘¢ ä¼šç¤¾é€£çµ¡ï¼ˆé…è»Šæ‹…å½“ï¼š090-1213-9803ï¼‰\n\nã€çµ¶å¯¾ç¦æ­¢äº‹é …ã€‘\nãƒ»ç¾å ´ã‹ã‚‰ã®é›¢è„±\nãƒ»äº‹æ•…å ±å‘Šã®éš è”½\nãƒ»ç¤ºè«‡äº¤æ¸‰\nãƒ»ã€Œç§ãŒæ‚ªã„ã€ç­‰ã®è²¬ä»»ã‚’èªã‚ã‚‹ç™ºè¨€\nãƒ»SNSã¸ã®æŠ•ç¨¿\n\nã€é›»ç·šåˆ‡æ–­æ™‚ã€‘\nè»Šä¸¡ã‹ã‚‰çµ¶å¯¾ã«é™ã‚Šãªã„â†’110ç•ªâ†’é…è»Šæ‹…å½“â†’æ±äº¬é›»åŠ›" }],
    quiz: [
      { q: "äº‹æ•…ç™ºç”Ÿæ™‚ã®3åŸå‰‡ã®é †ç•ªã¯ï¼Ÿ", o: ["é€šå ±â†’å®‰å…¨ç¢ºä¿â†’ä¼šç¤¾é€£çµ¡", "å®‰å…¨ç¢ºä¿â†’æ•‘è­·é€šå ±â†’ä¼šç¤¾é€£çµ¡", "ä¼šç¤¾é€£çµ¡â†’å®‰å…¨ç¢ºä¿â†’é€šå ±", "æ•‘è­·â†’ä¼šç¤¾é€£çµ¡â†’å®‰å…¨ç¢ºä¿"], a: 1 },
      { q: "äº‹æ•…æ™‚ã«çµ¶å¯¾ã—ã¦ã¯ã„ã‘ãªã„ã“ã¨ã¯ï¼Ÿ", o: ["å†™çœŸæ’®å½±", "è­¦å¯Ÿã¸ã®é€£çµ¡", "ç¤ºè«‡äº¤æ¸‰", "æ•‘è­·æ´»å‹•"], a: 2 },
      { q: "é›»ç·šåˆ‡æ–­æ™‚ã€æœ€åˆã«ã™ã¹ãã“ã¨ã¯ï¼Ÿ", o: ["è»Šä¸¡ã‹ã‚‰é™ã‚Šã‚‹", "è»Šä¸¡ã‹ã‚‰é™ã‚Šãªã„", "é›»ç·šã‚’è§¦ã‚‹", "å†™çœŸã‚’æ’®ã‚‹"], a: 1 },
      { q: "é…è»Šæ‹…å½“è€…ã®é›»è©±ç•ªå·ã¯ï¼Ÿ", o: ["0297-55-1380", "090-6301-8209", "090-1213-9803", "0120-995-007"], a: 2 },
      { q: "æ™‚é–“å¤–ã®é€£çµ¡å…ˆã¯ï¼Ÿ", o: ["090-1213-9803", "0297-55-1380", "090-6301-8209", "110"], a: 1 },
    ],
  },
  {
    id: "crane_safety", title: "ã‚¯ãƒ¬ãƒ¼ãƒ³æ“ä½œå®‰å…¨", icon: "ğŸ—ï¸", cat: "å®‰å…¨æ•™è‚²", color: "#A04000",
    secs: [{ title: "æ“ä½œå‰ç¢ºèªã¨æ“ä½œä¸­ã®æ³¨æ„", body: "ã€æ“ä½œå‰ç¢ºèªã€‘\nâ–¡ æŠ€èƒ½è¬›ç¿’ä¿®äº†è¨¼ã®æºå¸¯\nâ–¡ ã‚¯ãƒ¬ãƒ¼ãƒ³å„éƒ¨ã®ç‚¹æ¤œ\nâ–¡ éè² è·é˜²æ­¢è£…ç½®ã®ç¢ºèª\nâ–¡ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æœ€å¤§å¼µã‚Šå‡ºã—ãƒ»æ•·æ¿è¨­ç½®\n\nã€æ“ä½œä¸­ã®æ³¨æ„ã€‘\nãƒ»åŠã‚Šè·ã®ä¸‹ã«ç«‹å…¥ç¦æ­¢\nãƒ»æ€¥æ¿€ãªæ“ä½œç¦æ­¢\nãƒ»ç§»å‹•ã—ãªãŒã‚‰ã®æ“ä½œç¦æ­¢\nãƒ»è¤‡æ•°ãƒ¬ãƒãƒ¼åŒæ™‚æ“ä½œç¦æ­¢\nãƒ»æ—‹å›æ™‚ã¯é ­ä¸Šç¢ºèª\nãƒ»é¢¨é€Ÿ10m/sä»¥ä¸Šã¯ä½œæ¥­ä¸­æ­¢" }],
    quiz: [
      { q: "ã‚¯ãƒ¬ãƒ¼ãƒ³ä½œæ¥­ä¸­æ­¢ã®é¢¨é€Ÿæ¡ä»¶ã¯ï¼Ÿ", o: ["5m/sä»¥ä¸Š", "8m/sä»¥ä¸Š", "10m/sä»¥ä¸Š", "15m/sä»¥ä¸Š"], a: 2 },
      { q: "ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã§ç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã¯ï¼Ÿ", o: ["æœ€å¤§å¼µã‚Šå‡ºã—", "æ•·æ¿ä½¿ç”¨", "ç‰‡å´ã®ã¿ä½¿ç”¨", "æ°´å¹³ç¢ºèª"], a: 2 },
      { q: "Uå­—æºè“‹ã®ä¸Šã«ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­ç½®ã—ã¦ã‚ˆã„ã‹ï¼Ÿ", o: ["ã‚ˆã„", "æ¡ä»¶ä»˜ãã§ã‚ˆã„", "ç¦æ­¢", "ç®¡ç†è€…åˆ¤æ–­"], a: 2 },
      { q: "åŠã‚Šè·ã®ä¸‹ã«äººãŒç«‹ã¡å…¥ã‚‹ã“ã¨ã¯ï¼Ÿ", o: ["æ³¨æ„ã™ã‚Œã°OK", "çµ¶å¯¾ç¦æ­¢", "èª˜å°è€…ã®ã¿OK", "çŸ­æ™‚é–“ãªã‚‰OK"], a: 1 },
      { q: "è¤‡æ•°ãƒ¬ãƒãƒ¼ã®åŒæ™‚æ“ä½œã¯ï¼Ÿ", o: ["åŠ¹ç‡çš„ã§æ¨å¥¨", "ç¦æ­¢", "ç†Ÿç·´è€…ã¯OK", "ä½é€Ÿãªã‚‰OK"], a: 1 },
    ],
  },
  {
    id: "health_mgmt", title: "å¥åº·ç®¡ç†ãƒ»å­£ç¯€å¯¾ç­–", icon: "ğŸ’ª", cat: "å¥åº·ç®¡ç†", color: "#2E86C1",
    secs: [{ title: "å¥åº·ç®¡ç†ã¨å­£ç¯€åˆ¥å¯¾ç­–", body: "ã€ç¡çœ ã€‘1æ—¥7æ™‚é–“ä»¥ä¸Š\nã€é£²é…’ã€‘ãƒ“ãƒ¼ãƒ«ä¸­ç“¶1æœ¬ï¼åˆ†è§£ã«ç´„3ã€œ4æ™‚é–“\nã€é£Ÿäº‹ã€‘æœé£Ÿå¿…é ˆã€‚æ˜¼é£Ÿã¯è…¹å…«åˆ†ç›®\n\nã€ç†±ä¸­ç—‡äºˆé˜²ã€‘WBGT31ä»¥ä¸Šã¯åŸå‰‡å¤–ä½œæ¥­ä¸­æ­¢\n1æ™‚é–“ã«ã‚³ãƒƒãƒ—2ã€œ3æ¯ã®æ°´åˆ†è£œçµ¦\né‡åº¦ï¼ˆæ„è­˜éšœå®³ï¼‰â†’119ç•ª\n\nã€å†¬å­£ã€‘ã‚¹ã‚¿ãƒƒãƒ‰ãƒ¬ã‚¹ã‚¿ã‚¤ãƒ¤12æœˆã€œ3æœˆå¿…é ˆ\nã€èŠ±ç²‰ç—‡ã€‘ä¸»æ²»åŒ»ã«é‹è»¢æ¥­å‹™ã‚’ä¼ãˆã¦å‡¦æ–¹" }],
    quiz: [
      { q: "ãƒ“ãƒ¼ãƒ«ä¸­ç“¶1æœ¬ã®åˆ†è§£ã«å¿…è¦ãªæ™‚é–“ã¯ï¼Ÿ", o: ["1ã€œ2æ™‚é–“", "3ã€œ4æ™‚é–“", "5ã€œ6æ™‚é–“", "7ã€œ8æ™‚é–“"], a: 1 },
      { q: "ç†±ä¸­ç—‡ã§æ„è­˜éšœå®³ãŒã‚ã‚‹å ´åˆã®å¯¾å¿œã¯ï¼Ÿ", o: ["æ°´åˆ†è£œçµ¦", "æ¶¼ã—ã„å ´æ‰€ã§ä¼‘æ†©", "119ç•ªé€šå ±", "è‡ªåŠ›ã§å¸°ç¤¾"], a: 2 },
      { q: "WBGTä½•åº¦ä»¥ä¸Šã§åŸå‰‡å¤–ä½œæ¥­ä¸­æ­¢ï¼Ÿ", o: ["25", "28", "31", "33"], a: 2 },
      { q: "å†¬å­£ã®ã‚¹ã‚¿ãƒƒãƒ‰ãƒ¬ã‚¹ã‚¿ã‚¤ãƒ¤è£…ç€æœŸé–“ã¯ï¼Ÿ", o: ["11æœˆã€œ2æœˆ", "12æœˆã€œ3æœˆ", "1æœˆã€œ3æœˆ", "11æœˆã€œ3æœˆ"], a: 1 },
      { q: "èŠ±ç²‰ç—‡ã®è–¬ã«ã¤ã„ã¦æ­£ã—ã„ã®ã¯ï¼Ÿ", o: ["å¸‚è²©è–¬ã§OK", "ä¸»æ²»åŒ»ã«é‹è»¢æ¥­å‹™ã‚’ä¼ãˆã¦å‡¦æ–¹", "è–¬ãªã—ã§æˆ‘æ…¢", "åŒåƒšã®è–¬ã‚’å€Ÿã‚Šã‚‹"], a: 1 },
    ],
  },
  {
    id: "driving_safety", title: "èµ°è¡Œä¸­ã®å®‰å…¨", icon: "ğŸš›", cat: "å®‰å…¨é‹è»¢", color: "#6C3483",
    secs: [{ title: "é€Ÿåº¦åˆ¶é™ã¨æ”¹å–„åŸºæº–å‘Šç¤º", body: "ã€é€Ÿåº¦åˆ¶é™ã€‘ä½å®…è¡—20km/hä»¥ä¸‹\nã€ãªãŒã‚‰é‹è»¢ã€‘å³ç¦\nã€ã‚ãŠã‚Šé‹è»¢ã€‘å®‰å…¨ãªå ´æ‰€ã«ç§»å‹•â†’110ç•ª\n\nã€æ”¹å–„åŸºæº–å‘Šç¤ºã€‘\nãƒ»1æ—¥ã®æ‹˜æŸæ™‚é–“ï¼šåŸå‰‡13æ™‚é–“ä»¥å†…ï¼ˆä¸Šé™16æ™‚é–“ï¼‰\nãƒ»1ã‹æœˆï¼šåŸå‰‡284æ™‚é–“\nãƒ»é€£ç¶šé‹è»¢ï¼š4æ™‚é–“ä»¥å†…ã«30åˆ†ä»¥ä¸Šä¼‘æ†©\nãƒ»å‹¤å‹™é–“ä¼‘æ¯ï¼šç¶™ç¶š11æ™‚é–“ä»¥ä¸Š" }],
    quiz: [
      { q: "ä½å®…è¡—ã§ã®é€Ÿåº¦åˆ¶é™ã¯ï¼Ÿ", o: ["30km/hä»¥ä¸‹", "20km/hä»¥ä¸‹", "40km/hä»¥ä¸‹", "10km/hä»¥ä¸‹"], a: 1 },
      { q: "1æ—¥ã®æ‹˜æŸæ™‚é–“ã®åŸå‰‡ä¸Šé™ã¯ï¼Ÿ", o: ["10æ™‚é–“", "11æ™‚é–“", "13æ™‚é–“", "16æ™‚é–“"], a: 2 },
      { q: "é€£ç¶šé‹è»¢ã®ä¸Šé™ã¯ï¼Ÿ", o: ["2æ™‚é–“", "3æ™‚é–“", "4æ™‚é–“", "5æ™‚é–“"], a: 2 },
      { q: "ã‚ãŠã‚Šé‹è»¢ã‚’å—ã‘ãŸå ´åˆã®å¯¾å¿œã¯ï¼Ÿ", o: ["é€Ÿåº¦ã‚’ä¸Šã’ã‚‹", "æ€¥ãƒ–ãƒ¬ãƒ¼ã‚­", "å®‰å…¨ãªå ´æ‰€ã«ç§»å‹•ã—110ç•ª", "ã‚¯ãƒ©ã‚¯ã‚·ãƒ§ãƒ³"], a: 2 },
      { q: "é«˜é€Ÿé“è·¯ã§æ•…éšœã—ãŸå ´åˆã€æœ€åˆã«ã™ã‚‹ã“ã¨ã¯ï¼Ÿ", o: ["ä¿®ç†é–‹å§‹", "ãƒã‚¶ãƒ¼ãƒ‰ãƒ©ãƒ³ãƒ—ç‚¹ç¯", "110ç•ª", "ä¸‰è§’è¡¨ç¤ºæ¿è¨­ç½®"], a: 1 },
    ],
  },
  {
    id: "kyt_training", title: "å±é™ºäºˆçŸ¥ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°", icon: "âš ï¸", cat: "KYT", color: "#D4AC0D",
    secs: [{ title: "KYT 4ãƒ©ã‚¦ãƒ³ãƒ‰æ³•", body: "ç¬¬1Rï¼šå±é™ºã®æ´—ã„å‡ºã—ï¼ˆã©ã‚“ãªå±é™ºãŒã‚ã‚‹ã‹ï¼‰\nç¬¬2Rï¼šå±é™ºã®çµã‚Šè¾¼ã¿ï¼ˆæœ€ã‚‚é‡è¦ãªå±é™ºã¯ï¼‰\nç¬¬3Rï¼šå¯¾ç­–ã®ç«‹æ¡ˆï¼ˆã‚ãªãŸãªã‚‰ã©ã†ã™ã‚‹ï¼‰\nç¬¬4Rï¼šè¡Œå‹•ç›®æ¨™ã®è¨­å®šï¼ˆæŒ‡å·®ã—å‘¼ç§°é …ç›®ã‚’æ±ºå®šï¼‰\n\nã€ã‚·ãƒŠãƒªã‚ªä¾‹ã€‘\nãƒ»ä½å®…è¡—ã§ã®ãƒãƒƒã‚¯èµ°è¡Œâ†’é™è»Šã—ã¦å¾Œæ–¹ç¢ºèª\nãƒ»é›¨å¤©æ™‚ã®è·é™ã‚ã—â†’æ•·æ¿ã‚’å¤šã‚ã«ä½¿ç”¨\nãƒ»é›»ç·šä¸‹ã®ã‚¯ãƒ¬ãƒ¼ãƒ³ä½œæ¥­â†’å®‰å…¨è·é›¢ã‚’ç¢ºä¿" }],
    quiz: [
      { q: "KYTç¬¬1ãƒ©ã‚¦ãƒ³ãƒ‰ã®ç›®çš„ã¯ï¼Ÿ", o: ["å¯¾ç­–ã®ç«‹æ¡ˆ", "å±é™ºã®æ´—ã„å‡ºã—", "è¡Œå‹•ç›®æ¨™ã®è¨­å®š", "å±é™ºã®çµã‚Šè¾¼ã¿"], a: 1 },
      { q: "KYTç¬¬4ãƒ©ã‚¦ãƒ³ãƒ‰ã§è¡Œã†ã“ã¨ã¯ï¼Ÿ", o: ["å±é™ºã®æ´—ã„å‡ºã—", "å¯¾ç­–ã®ç«‹æ¡ˆ", "è¡Œå‹•ç›®æ¨™ãƒ»æŒ‡å·®ã—å‘¼ç§°", "å±é™ºã®çµã‚Šè¾¼ã¿"], a: 2 },
      { q: "ãƒãƒƒã‚¯èµ°è¡Œæ™‚ã«æœ€ã‚‚æ³¨æ„ã™ã¹ãã“ã¨ã¯ï¼Ÿ", o: ["é€Ÿåº¦", "å¾Œæ–¹ã®å®‰å…¨ç¢ºèª", "ãƒãƒ³ãƒ‰ãƒ«æ“ä½œ", "ãƒŸãƒ©ãƒ¼èª¿æ•´"], a: 1 },
      { q: "é›¨å¤©æ™‚ã®ã‚¯ãƒ¬ãƒ¼ãƒ³ä½œæ¥­ã§æ³¨æ„ã™ã¹ãã“ã¨ã¯ï¼Ÿ", o: ["ä½œæ¥­é€Ÿåº¦", "ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ²ˆä¸‹", "è·ç‰©ã®è‰²", "æ›¸é¡ã®æ¿¡ã‚Œ"], a: 1 },
      { q: "æŒ‡å·®ã—å‘¼ç§°ã®ç›®çš„ã¯ï¼Ÿ", o: ["å£°ã‚’å‡ºã™ç·´ç¿’", "ç¢ºèªã®ç¢ºå®Ÿæ€§ã‚’é«˜ã‚ã‚‹", "å‘¨å›²ã«çŸ¥ã‚‰ã›ã‚‹", "ãƒãƒ‹ãƒ¥ã‚¢ãƒ«é€šã‚Šã«ã™ã‚‹"], a: 1 },
    ],
  },
  {
    id: "loading_method", title: "ç©è¾¼ãƒ»è·ç· ã‚", icon: "ğŸ“¦", cat: "åŸºæœ¬æ¥­å‹™", color: "#1A5276",
    secs: [{ title: "ç©è¾¼ã¨è·ç· ã‚ã®åŸºæœ¬", body: "ãƒ»é…é€é †ç•ªã‚’è€ƒæ…®ã—ãŸç©è¾¼\nãƒ»é‡å¿ƒã‚’ä½ãåã‚Šãªãç©è¼‰\nãƒ»ãƒ©ãƒƒã‚·ãƒ³ã‚°ãƒ™ãƒ«ãƒˆæœ€ä½2æœ¬ä»¥ä¸Š\nãƒ»è£½å“é–“ã«è§’å½“ã¦ã‚’å…¥ã‚Œã‚‹\nãƒ»å¾Œéƒ¨ã¯ã¿å‡ºã—éƒ¨ã«èµ¤ã„å¸ƒ" }],
    quiz: [
      { q: "ãƒ©ãƒƒã‚·ãƒ³ã‚°ãƒ™ãƒ«ãƒˆã¯æœ€ä½ä½•æœ¬å¿…è¦ï¼Ÿ", o: ["1æœ¬", "2æœ¬", "3æœ¬", "4æœ¬"], a: 1 },
      { q: "ç©è¾¼ã§è€ƒæ…®ã™ã¹ãé †ç•ªã¯ï¼Ÿ", o: ["é‡ã„é †", "è»½ã„é †", "é…é€é †", "ã‚µã‚¤ã‚ºé †"], a: 2 },
      { q: "ã¯ã¿å‡ºã—éƒ¨åˆ†ã«å¿…è¦ãªã‚‚ã®ã¯ï¼Ÿ", o: ["ãƒ†ãƒ¼ãƒ—", "èµ¤ã„å¸ƒ", "ãƒ­ãƒ¼ãƒ—", "ã‚·ãƒ¼ãƒ«"], a: 1 },
    ],
  },
  {
    id: "site_rules", title: "ç¾å ´ãƒãƒŠãƒ¼ãƒ»ãƒ«ãƒ¼ãƒ«", icon: "ğŸ ", cat: "ãƒãƒŠãƒ¼", color: "#117A65",
    secs: [{ title: "ç¾å ´ã§ã®ãƒ«ãƒ¼ãƒ«", body: "ãƒ»é£ã‚Šæ–¹ãƒ»æ°´ç³¸ãƒ»é¥…é ­ã‚’çµ¶å¯¾ã«ç ´æã—ãªã„\nãƒ»åœ°ç¸„ã®å†…å´ã«è£½å“ã‚’ç½®ã‹ãªã„\nãƒ»é˜²æ¹¿ã‚·ãƒ¼ãƒˆã‚’æ±šã•ãªã„\nãƒ»è¿‘éš£ä½å®…ã®å¡€ãƒ»è»Šä¸¡ãƒ»æ¤æ ½ã«æ³¨æ„\nãƒ»ç¾å ´ã‚’æ±šã—ãŸå ´åˆã¯å¿…ãšæ¸…æƒ\nãƒ»ç¾å ´ãƒ»ç¾å ´ä»˜è¿‘ã¯ç¦ç…™" }],
    quiz: [
      { q: "é£ã‚Šæ–¹ãƒ»æ°´ç³¸ã‚’ç ´æã—ãŸå ´åˆã¯ï¼Ÿ", o: ["é»™ã£ã¦ç›´ã™", "ç„¡è¦–ã™ã‚‹", "ã™ãã«å ±å‘Š", "å¸°ç¤¾å¾Œã«å ±å‘Š"], a: 2 },
      { q: "åœ°ç¸„ã®å†…å´ã«è£½å“ã‚’ç½®ã„ã¦ã‚ˆã„ã‹ï¼Ÿ", o: ["ã‚ˆã„", "ç¦æ­¢", "ç›£ç£ã®è¨±å¯ãŒã‚ã‚Œã°OK", "å°ã•ã„ã‚‚ã®ã¯OK"], a: 1 },
      { q: "ç¾å ´ã§å–«ç…™ã—ã¦ã‚ˆã„å ´æ‰€ã¯ï¼Ÿ", o: ["è»Šå†…", "ç¾å ´ã‹ã‚‰é›¢ã‚ŒãŸå ´æ‰€", "ãƒˆã‚¤ãƒ¬ä»˜è¿‘", "ç¦ç…™ï¼ˆå ´æ‰€ã‚’å•ã‚ãšï¼‰"], a: 3 },
    ],
  },
  {
    id: "law12_edu", title: "æ³•å®š12é …ç›®æ•™è‚²", icon: "ğŸ“š", cat: "æ³•ä»¤", color: "#34495E",
    secs: [{ title: "æ³•å®š12é …ç›®ã®æ¦‚è¦", body: "ã€ç¬¬1é …ã€‘å®‰å…¨æœ€å„ªå…ˆã®å¿ƒæ§‹ãˆ\nã€ç¬¬2é …ã€‘æ—¥å¸¸ç‚¹æ¤œãƒ»ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯ï¼ˆ0.00mg/Lï¼‰\nã€ç¬¬3é …ã€‘å†…è¼ªå·®ãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒãƒ³ã‚°ãƒ»æ­»è§’\nã€ç¬¬4é …ã€‘æ­£ã—ã„ç©è¼‰æ–¹æ³•\nã€ç¬¬5é …ã€‘éç©è¼‰ã®å±é™ºæ€§\nã€ç¬¬7é …ã€‘é«˜ã•ãƒ»é‡é‡åˆ¶é™ã®ç¢ºèª\nã€ç¬¬10é …ã€‘ã€Œã ã‚ã†ã€â†’ã€Œã‹ã‚‚ã—ã‚Œãªã„ã€é‹è»¢\nã€ç¬¬12é …ã€‘ãƒãƒƒã‚¯ã‚«ãƒ¡ãƒ©ã¯è£œåŠ©ã€ç›®è¦–ç¢ºèªå¿…é ˆ" }],
    quiz: [
      { q: "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯ã®åŸºæº–å€¤ã¯ï¼Ÿ", o: ["0.15mg/Lä»¥ä¸‹", "0.00mg/L", "0.25mg/Lä»¥ä¸‹", "0.10mg/Lä»¥ä¸‹"], a: 1 },
      { q: "éç©è¼‰ã®ãƒªã‚¹ã‚¯ã«å«ã¾ã‚Œãªã„ã‚‚ã®ã¯ï¼Ÿ", o: ["åˆ¶å‹•è·é›¢å¢—å¤§", "æ¨ªè»¢ãƒªã‚¹ã‚¯", "ç‡ƒè²»å‘ä¸Š", "è¡Œæ”¿å‡¦åˆ†"], a: 2 },
      { q: "ãƒˆãƒ©ãƒƒã‚¯ç‰¹æœ‰ã®æ³¨æ„ç‚¹ã§ãªã„ã‚‚ã®ã¯ï¼Ÿ", o: ["å†…è¼ªå·®", "ã‚ªãƒ¼ãƒãƒ¼ãƒãƒ³ã‚°", "æ­»è§’", "ä½é‡å¿ƒ"], a: 3 },
    ],
  },
  {
    id: "checklist_edu", title: "ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã®ä½¿ã„æ–¹", icon: "âœ…", cat: "åŸºæœ¬æ¥­å‹™", color: "#1E8449",
    secs: [{ title: "ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆæ´»ç”¨æ³•", body: "ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã¯å‡ºç™ºå‰ãƒ»ç¾å ´åˆ°ç€æ™‚ãƒ»é€€å‡ºå‰ã®å„æ®µéšã§ä½¿ç”¨ã—ã¾ã™ã€‚\nä¸Šã‹ã‚‰é †ç•ªã«1ã¤ãšã¤ç¢ºèªã—ã€é£›ã°ã—èª­ã¿ã‚„è¨˜æ†¶ã«é ¼ã‚‹ã“ã¨ã¯é¿ã‘ã¦ãã ã•ã„ã€‚" }],
    quiz: [
      { q: "ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ä½¿ã†ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ï¼Ÿ", o: ["å‡ºç™ºå‰ã®ã¿", "ä½œæ¥­ã®å„æ®µéšã§", "å¸°ç¤¾å¾Œã®ã¿", "é€±1å›"], a: 1 },
      { q: "ãƒã‚§ãƒƒã‚¯æ¼ã‚Œã‚’é˜²ãæ–¹æ³•ã¯ï¼Ÿ", o: ["æš—è¨˜ã™ã‚‹", "ä¸Šã‹ã‚‰é †ã«ç¢ºèª", "é£›ã°ã—èª­ã¿", "ã¾ã¨ã‚ã¦ãƒã‚§ãƒƒã‚¯"], a: 1 },
    ],
  },
  {
    id: "driver_check", title: "æ•™è‚²ãƒã‚§ãƒƒã‚¯è¡¨", icon: "ğŸ“", cat: "æ•™è‚²", color: "#6C3483",
    secs: [{ title: "æ•™è‚²ãƒã‚§ãƒƒã‚¯è¡¨ã®ä½¿ã„æ–¹", body: "æ•™è‚²å®Œäº†å¾Œã¯å—è¬›è€…ã®ç½²åã¨æ—¥ä»˜ãŒå¿…è¦ã§ã™ã€‚\nã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã¯æœ€å¤§å¼µã‚Šå‡ºã—å¿…é ˆã€ç‰‡å´ã®ã¿ã¯ç¦æ­¢ã§ã™ã€‚" }],
    quiz: [
      { q: "æ•™è‚²å®Œäº†å¾Œã«å¿…è¦ãªã“ã¨ã¯ï¼Ÿ", o: ["å£é ­å ±å‘Š", "å—è¬›è€…ç½²åã¨æ—¥ä»˜", "å†™çœŸæ’®å½±", "ãƒ†ã‚¹ãƒˆå—é¨“"], a: 1 },
      { q: "ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã§ç¦æ­¢ãªã®ã¯ï¼Ÿ", o: ["æœ€å¤§å¼µã‚Šå‡ºã—", "æ•·æ¿ä½¿ç”¨", "ç‰‡å´ã®ã¿ä½¿ç”¨", "æ°´å¹³ç¢ºèª"], a: 2 },
    ],
  },
  {
    id: "customer_service", title: "é¡§å®¢æº€è¶³ãƒ»ãƒãƒŠãƒ¼", icon: "ğŸ¤", cat: "é¡§å®¢æº€è¶³", color: "#B7950B",
    secs: [{ title: "ãŠå®¢æ§˜å¯¾å¿œã®åŸºæœ¬", body: "ãƒ»æ™‚é–“æŒ‡å®šå³å®ˆï¼ˆæ—©ã™ãã¦ã‚‚NGï¼‰\nãƒ»æ¸…æ½”ãªä½œæ¥­æœ\nãƒ»ç©æ¥µçš„ãªæŒ¨æ‹¶ã¨ä¸å¯§ãªè¨€è‘‰é£ã„\nãƒ»ç¾å ´ãƒ»ç¾å ´ä»˜è¿‘ã¯ç¦ç…™\nãƒ»é…ã‚Œã‚‹å ´åˆã¯äº‹å‹™æ‰€ã¸æ—©ã‚ã«å ±å‘Š" }],
    quiz: [
      { q: "æ™‚é–“æŒ‡å®šã«å¯¾ã—ã¦æ­£ã—ã„è¡Œå‹•ã¯ï¼Ÿ", o: ["æ—©ã™ãã¦ã‚‚OK", "æŒ‡å®šæ™‚é–“ã¡ã‚‡ã†ã©ã«åˆ°ç€", "æŒ‡å®šæ™‚é–“å³å®ˆï¼ˆæ—©ã™ãã‚‚NGï¼‰", "å¤šå°‘é…ã‚Œã¦ã‚‚å•é¡Œãªã—"], a: 2 },
      { q: "ç¾å ´ãƒ»ç¾å ´ä»˜è¿‘ã§ã‚¿ãƒã‚³ã¯ï¼Ÿ", o: ["OK", "ç¦ç…™", "ä¼‘æ†©ä¸­ã¯OK", "äººãŒã„ãªã‘ã‚Œã°OK"], a: 1 },
    ],
  },
  {
    id: "mistake_prevent", title: "ãƒŸã‚¹é˜²æ­¢", icon: "ğŸ”", cat: "å®‰å…¨æ•™è‚²", color: "#7D3C98",
    secs: [{ title: "ã‚ˆãã‚ã‚‹ãƒŸã‚¹ã¨é˜²æ­¢ç­–", body: "ã€èª¤é…é€ã€‘ä½æ‰€ãƒ»ç‰©ä»¶åã‚’é…è»Šè¡¨ã¨ç…§åˆ\nã€æ•°é‡ãƒŸã‚¹ã€‘å£°ã«å‡ºã—ã¦1ã¤ãšã¤æ•°ãˆã‚‹\nã€æ˜ç´°æ›¸ç½®ãå¿˜ã‚Œã€‘é€€å‡ºå‰ã«æ›¸é¡ã®ä»•åˆ†ã‘ã‚’ç¢ºèª\nã€ãƒ–ãƒ¼ãƒ æ ¼ç´å¿˜ã‚Œã€‘å‡ºç™ºå‰5ç‚¹ç¢ºèªã‚’æ¯å›å®Ÿæ–½\nã€æ•·æ¿å›åå¿˜ã‚Œã€‘é€€å‡ºå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã«å«ã‚ã‚‹" }],
    quiz: [
      { q: "èª¤é…é€ã‚’é˜²ãæ–¹æ³•ã¯ï¼Ÿ", o: ["æ€¥ã„ã§é…é€", "åˆ°ç€æ™‚ã«ä½æ‰€ãƒ»ç‰©ä»¶åã‚’é…è»Šè¡¨ã¨ç…§åˆ", "ãƒŠãƒ“ã«ä»»ã›ã‚‹", "é›»è©±ç¢ºèªä¸è¦"], a: 1 },
      { q: "æ•°é‡ãƒŸã‚¹ã‚’é˜²ãæ–¹æ³•ã¯ï¼Ÿ", o: ["ç›®è¦–ã§ç¢ºèª", "å£°ã«å‡ºã—ã¦1ã¤ãšã¤æ•°ãˆã‚‹", "æ„Ÿè¦šã§åˆ¤æ–­", "å†™çœŸã§ç¢ºèª"], a: 1 },
      { q: "æ˜ç´°æ›¸ç½®ãå¿˜ã‚Œã‚’é˜²ãæ–¹æ³•ã¯ï¼Ÿ", o: ["è¨˜æ†¶ã«é ¼ã‚‹", "é€€å‡ºå‰ã«æ›¸é¡ã®ä»•åˆ†ã‘ã‚’ç¢ºèª", "å¾Œã§å–ã‚Šã«æˆ»ã‚‹", "é›»è©±ã§ç¢ºèª"], a: 1 },
    ],
  },
];

const TOTAL_POOL = COURSES.reduce((n, c) => n + c.quiz.length, 0);

/* ===== å›ç­”é›†ï¼ˆç®¡ç†è€…ç”¨ï¼‰ ===== */
const ANSWER_SHEETS = [
  { title: "äº‹æ•…å¯¾å¿œãƒ†ã‚¹ãƒˆ", content: "Q1: äº‹æ•…ç™ºç”Ÿæ™‚ã®3åŸå‰‡ â†’ â‘ å®‰å…¨ç¢ºä¿â†’â‘¡æ•‘è­·é€šå ±â†’â‘¢ä¼šç¤¾é€£çµ¡\nQ2: çµ¶å¯¾ç¦æ­¢äº‹é … â†’ ç¾å ´é›¢è„±ãƒ»å ±å‘Šéš è”½ãƒ»ç¤ºè«‡äº¤æ¸‰\nQ3: é…è»Šæ‹…å½“è€…é›»è©± â†’ 090-1213-9803\nQ4: é›»ç·šåˆ‡æ–­æ™‚ â†’ è»Šä¸¡ã‹ã‚‰é™ã‚Šãªã„\nQ5: æ™‚é–“å¤–é€£çµ¡å…ˆ â†’ 0297-55-1380" },
  { title: "ã‚¯ãƒ¬ãƒ¼ãƒ³æ“ä½œãƒ†ã‚¹ãƒˆ", content: "Q1: ä½œæ¥­ä¸­æ­¢é¢¨é€Ÿ â†’ 10m/sä»¥ä¸Š\nQ2: ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ç¦æ­¢ â†’ ç‰‡å´ã®ã¿ä½¿ç”¨\nQ3: Uå­—æºè“‹ä¸Šè¨­ç½® â†’ ç¦æ­¢\nQ4: åŠã‚Šè·ä¸‹ç«‹å…¥ â†’ çµ¶å¯¾ç¦æ­¢\nQ5: è¤‡æ•°ãƒ¬ãƒãƒ¼åŒæ™‚æ“ä½œ â†’ ç¦æ­¢" },
  { title: "å¥åº·ç®¡ç†ãƒ†ã‚¹ãƒˆ", content: "Q1: ãƒ“ãƒ¼ãƒ«ä¸­ç“¶1æœ¬åˆ†è§£ â†’ 3ã€œ4æ™‚é–“\nQ2: æ„è­˜éšœå®³æ™‚ â†’ 119ç•ª\nQ3: WBGT â†’ 31ä»¥ä¸Šã§ä¸­æ­¢\nQ4: ã‚¹ã‚¿ãƒƒãƒ‰ãƒ¬ã‚¹ â†’ 12ã€œ3æœˆ\nQ5: èŠ±ç²‰ç—‡ã®è–¬ â†’ ä¸»æ²»åŒ»ã«é‹è»¢æ¥­å‹™ã‚’ä¼ãˆã‚‹" },
];

/* ===== ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆçŸ¥è­˜ãƒ™ãƒ¼ã‚¹ ===== */
const KB = `ã‚ãªãŸã¯ãƒ¡ãƒ¼ã‚¯ã‚¹æ ªå¼ä¼šç¤¾ ç‰©æµäº‹æ¥­éƒ¨ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚„å¾“æ¥­å“¡ã‹ã‚‰ã®è³ªå•ã«æ­£ç¢ºãƒ»ç°¡æ½”ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚

ã€ç·Šæ€¥é€£çµ¡å…ˆã€‘é…è»Šæ‹…å½“è€…ï¼š090-1213-9803ï¼èŒ¨åŸå·¥å ´å—æ³¨èª²ï¼š090-6301-8209ï¼ˆ8:00ã€œ17:00ï¼‰ï¼æœ¬ç¤¾ï¼š0297-55-1380ï¼æ™‚é–“å¤–ï¼š0297-55-1380ï¼ˆè‡ªå‹•è»¢é€ï¼‰ï¼æ±äº¬é›»åŠ›ï¼š0120-995-007ï¼NTTï¼š0120-444-113

ã€å‡ºç™ºå‰5ç‚¹ç¢ºèªã€‘â‘ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´â‘¡ãƒ–ãƒ¼ãƒ æ ¼ç´â‘¢è£½å“è·ç· ã‚â‘£éƒ¨æè·ç· ã‚â‘¤ä¸å…·åˆä¿®æ­£
ã€é€€å‡ºå‰5ç‚¹ç¢ºèªã€‘â‘ ãƒ–ãƒ¼ãƒ æ ¼ç´â‘¡ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´â‘¢ãƒ¯ã‚¤ãƒ¤ãƒ¼ä¹±å·»ãªã—â‘£ãƒ•ãƒƒã‚¯æ ¼ç´â‘¤PTOè§£é™¤

ã€äº‹æ•…3åŸå‰‡ã€‘å®‰å…¨ç¢ºä¿â†’æ•‘è­·é€šå ±ï¼ˆ119ãƒ»110ï¼‰â†’ä¼šç¤¾é€£çµ¡ï¼ˆ090-1213-9803ï¼‰ã€‚çµ¶å¯¾ç¦æ­¢ï¼šç¾å ´é›¢è„±ãƒ»å ±å‘Šéš è”½ãƒ»ç¤ºè«‡äº¤æ¸‰ãƒ»è²¬ä»»èªã‚ã‚‹ç™ºè¨€ãƒ»SNSæŠ•ç¨¿
ã€é›»ç·šåˆ‡æ–­ã€‘è»Šä¸¡ã‹ã‚‰é™ã‚Šãªã„â†’110ç•ªâ†’é…è»Šæ‹…å½“â†’æ±äº¬é›»åŠ›
ã€ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã€‘æœ€å¤§å¼µã‚Šå‡ºã—å¿…é ˆã€‚ç‰‡å´ç¦æ­¢ã€‚Uå­—æºè“‹ä¸Šç¦æ­¢ã€‚æ•·æ¿å¿…é ˆã€‚
ã€ã‚¯ãƒ¬ãƒ¼ãƒ³ä¸­æ­¢ã€‘é¢¨é€Ÿ10m/sä»¥ä¸Š
ã€å¥åº·ã€‘ç¡çœ 7hä»¥ä¸Šã€‚ãƒ“ãƒ¼ãƒ«ä¸­ç“¶1æœ¬=3ã€œ4æ™‚é–“ã€‚ç†±ä¸­ç—‡ï¼šWBGT31ä»¥ä¸Šã¯ä½œæ¥­ä¸­æ­¢ã€‚
ã€æ”¹å–„åŸºæº–ã€‘1æ—¥æ‹˜æŸ13hä»¥å†…ï¼ˆä¸Šé™16hï¼‰ã€‚æœˆ284hã€‚é€£ç¶šé‹è»¢4hä»¥å†…ã«30åˆ†ä¼‘æ†©ã€‚å‹¤å‹™é–“ä¼‘æ¯11hä»¥ä¸Šã€‚
ã€KYT4Ræ³•ã€‘â‘ å±é™ºå‡ºã—â†’â‘¡çµã‚Šè¾¼ã¿â†’â‘¢å¯¾ç­–â†’â‘£è¡Œå‹•ç›®æ¨™ãƒ»æŒ‡å·®ã—å‘¼ç§°

å›ç­”ã¯æ—¥æœ¬èªã§ç°¡æ½”ã«ã€‚ä¸æ˜ãªå†…å®¹ã¯ã€Œç®¡ç†è€…ã«ç¢ºèªã—ã¦ãã ã•ã„ï¼ˆ090-1213-9803ï¼‰ã€ã¨æ¡ˆå†…ã€‚`;

const SUGGESTIONS = [
  "å‡ºç™ºå‰5ç‚¹ç¢ºèªã®å†…å®¹ã¯ï¼Ÿ",
  "äº‹æ•…ãŒèµ·ããŸã¨ãã©ã†ã™ã‚Œã°ï¼Ÿ",
  "é›»ç·šã«è§¦ã‚ŒãŸå ´åˆã®å¯¾å‡¦æ³•",
  "æ”¹å–„åŸºæº–å‘Šç¤ºã®æ‹˜æŸæ™‚é–“ã¯ï¼Ÿ",
  "ç†±ä¸­ç—‡ã®å¯¾å‡¦æ³•ã¯ï¼Ÿ",
  "æ™‚é–“å¤–ã®é€£çµ¡å…ˆã¯ï¼Ÿ",
];

/* ===== viewport metaï¼ˆã‚¹ãƒãƒ›å¯¾å¿œï¼‰ ===== */
if (typeof document !== "undefined") {
  let meta = document.querySelector('meta[name="viewport"]');
  if (!meta) {
    meta = document.createElement("meta");
    meta.name = "viewport";
    document.head.appendChild(meta);
  }
  meta.content = "width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no";
}

/* ===== useMediaQuery ãƒ•ãƒƒã‚¯ ===== */
function useIsMobile(breakpoint = 640) {
  const [isMobile, setIsMobile] = useState(false);
  useEffect(() => {
    const check = () => setIsMobile(window.innerWidth < breakpoint);
    check();
    window.addEventListener("resize", check);
    return () => window.removeEventListener("resize", check);
  }, [breakpoint]);
  return isMobile;
}

/* ===== Login ===== */
function Login({ onLogin }) {
  const [empId, setEmpId] = useState("");
  const [name, setName] = useState("");
  const [pw, setPw] = useState("");
  const [err, setErr] = useState("");
  const login = () => {
    if (!empId.trim() || !name.trim()) { setErr("ç¤¾å“¡ç•ªå·ã¨æ°åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"); return; }
    if (pw !== COMPANY_PASS) { setErr("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™"); return; }
    onLogin({ empId: empId.trim(), name: name.trim() });
  };
  return (
    <div style={{ minHeight: "100vh", background: "linear-gradient(135deg,#0d1b2a,#1b2d4a,#0d1b2a)", display: "flex", alignItems: "center", justifyContent: "center", padding: 20, fontFamily: "'Helvetica Neue',Arial,'Hiragino Sans',sans-serif" }}>
      <div style={{ background: "#fff", borderRadius: 20, padding: "40px 28px", width: "100%", maxWidth: 420, boxShadow: "0 20px 60px rgba(0,0,0,0.3)" }}>
        <div style={{ textAlign: "center", marginBottom: 28 }}>
          <div style={{ fontSize: 56, marginBottom: 12 }}>ğŸšš</div>
          <h1 style={{ fontSize: 22, fontWeight: 700, color: "#1a2d4a", marginBottom: 6 }}>ãƒ¡ãƒ¼ã‚¯ã‚¹ç‰©æµäº‹æ¥­éƒ¨</h1>
          <p style={{ fontSize: 15, color: "#888" }}>çµ±åˆãƒãƒ¼ã‚¿ãƒ«ã‚·ã‚¹ãƒ†ãƒ </p>
        </div>
        <div style={{ display: "flex", flexDirection: "column", gap: 16 }}>
          <div>
            <label style={{ fontSize: 14, fontWeight: 600, color: "#555", display: "block", marginBottom: 6 }}>ç¤¾å“¡ç•ªå·</label>
            <input value={empId} onChange={(e) => { setEmpId(e.target.value); setErr(""); }} placeholder="ä¾‹: D001" style={S.input} />
          </div>
          <div>
            <label style={{ fontSize: 14, fontWeight: 600, color: "#555", display: "block", marginBottom: 6 }}>æ°å</label>
            <input value={name} onChange={(e) => { setName(e.target.value); setErr(""); }} placeholder="ä¾‹: å±±ç”°å¤ªéƒ" style={S.input} />
          </div>
          <div>
            <label style={{ fontSize: 14, fontWeight: 600, color: "#555", display: "block", marginBottom: 6 }}>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
            <input type="password" value={pw} onChange={(e) => { setPw(e.target.value); setErr(""); }} onKeyDown={(e) => e.key === "Enter" && login()} placeholder="ç¤¾å†…å…±é€šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" style={S.input} />
          </div>
          {err && <div style={{ background: "#ffeaea", color: "#c0392b", padding: "12px 16px", borderRadius: 10, fontSize: 15, textAlign: "center" }}>{err}</div>}
          <button onClick={login} style={{ ...S.btn("#1B4F72"), width: "100%", padding: "16px", fontSize: 17, marginTop: 4 }}>ãƒ­ã‚°ã‚¤ãƒ³</button>
        </div>
        <p style={{ textAlign: "center", fontSize: 13, color: "#bbb", marginTop: 24 }}>â€» ç¤¾å†…é–¢ä¿‚è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™</p>
      </div>
    </div>
  );
}

/* ===== Headerï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œå¼·åŒ–ï¼‰ ===== */
function Header({ tab, setTab, user, onLogout }) {
  const isMobile = useIsMobile();
  const tabs = [
    { id: "home", icon: "ğŸ ", label: "ãƒ›ãƒ¼ãƒ " },
    { id: "manual", icon: "ğŸ“„", label: "æ‰‹é †æ›¸" },
    { id: "elearning", icon: "ğŸ“", label: "Eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°" },
    { id: "chat", icon: "ğŸ¤–", label: "AIãƒãƒ£ãƒƒãƒˆ" },
    { id: "admin", icon: "ğŸ”", label: "ç®¡ç†è€…" },
  ];
  return (
    <header style={{ background: "linear-gradient(135deg,#0d1b2a,#1B4F72)", position: "sticky", top: 0, zIndex: 100, boxShadow: "0 2px 12px rgba(0,0,0,0.15)" }}>
      <div style={{ maxWidth: 1200, margin: "0 auto", padding: isMobile ? "10px 12px 0" : "14px 16px 0" }}>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
          <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
            <span style={{ fontSize: isMobile ? 22 : 26 }}>ğŸšš</span>
            <div>
              <div style={{ color: "#fff", fontSize: isMobile ? 14 : 16, fontWeight: 700 }}>ãƒ¡ãƒ¼ã‚¯ã‚¹ç‰©æµäº‹æ¥­éƒ¨</div>
              {!isMobile && <div style={{ color: "#3498DB", fontSize: 11 }}>çµ±åˆãƒãƒ¼ã‚¿ãƒ«</div>}
            </div>
          </div>
          <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
            {!isMobile && <span style={{ color: "#ccc", fontSize: 13 }}>{user?.name}</span>}
            <button onClick={onLogout} style={{ padding: isMobile ? "6px 10px" : "8px 14px", borderRadius: 8, border: "1px solid rgba(255,255,255,0.3)", background: "transparent", color: "#fff", fontSize: isMobile ? 12 : 13, cursor: "pointer" }}>
              ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
            </button>
          </div>
        </div>
        <nav style={{ display: "flex", gap: 0, marginTop: isMobile ? 8 : 12, overflowX: "auto", WebkitOverflowScrolling: "touch", paddingBottom: 2, msOverflowStyle: "none", scrollbarWidth: "none" }}>
          {tabs.map((t) => (
            <button
              key={t.id}
              onClick={() => setTab(t.id)}
              style={{
                background: tab === t.id ? "rgba(255,255,255,0.15)" : "transparent",
                border: "none", color: "#fff",
                padding: isMobile ? "10px 12px" : "12px 16px",
                cursor: "pointer",
                fontSize: isMobile ? 13 : 14,
                borderRadius: "8px 8px 0 0",
                opacity: tab === t.id ? 1 : 0.6,
                fontWeight: tab === t.id ? 700 : 400,
                borderBottom: tab === t.id ? "3px solid #3498DB" : "3px solid transparent",
                whiteSpace: "nowrap", minWidth: "fit-content",
                flex: isMobile ? 1 : "none",
                textAlign: "center",
              }}
            >
              {t.icon} {isMobile ? "" : t.label}
              {isMobile && <div style={{ fontSize: 10, marginTop: 2, opacity: 0.8 }}>{t.label}</div>}
            </button>
          ))}
        </nav>
      </div>
    </header>
  );
}

/* ===== Home ===== */
function Home({ setTab, user }) {
  const isMobile = useIsMobile();
  const cards = [
    { icon: "ğŸ“„", title: "æ‰‹é †æ›¸ã‚’ç¢ºèªã™ã‚‹", desc: "ç´å…¥æ‰‹é †ãƒ»äº‹æ•…å¯¾å¿œãƒ»ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆç­‰", tab: "manual", color: "#1B4F72" },
    { icon: "ğŸ“", title: "Eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å—è¬›", desc: `å…¨${COURSES.length}ã‚³ãƒ¼ã‚¹å­¦ç¿’ãƒ»ãƒ©ãƒ³ãƒ€ãƒ 30å•ãƒ†ã‚¹ãƒˆ`, tab: "elearning", color: "#1E8449" },
    { icon: "ğŸ¤–", title: "AIã«è³ªå•ã™ã‚‹", desc: "æ‰‹é †æ›¸ã®å†…å®¹ã‚’Q&Aã§å³ç¢ºèª", tab: "chat", color: "#6C3483" },
  ];
  return (
    <div style={{ maxWidth: 1000, margin: "0 auto", padding: isMobile ? "20px 12px" : "32px 16px" }}>
      <div style={{ textAlign: "center", marginBottom: isMobile ? 20 : 32 }}>
        <div style={{ fontSize: isMobile ? 42 : 52, marginBottom: 10 }}>ğŸšš</div>
        <h1 style={{ fontSize: isMobile ? 20 : 26, fontWeight: 700, color: "#1a2d4a", marginBottom: 8 }}>ç‰©æµäº‹æ¥­éƒ¨ çµ±åˆãƒãƒ¼ã‚¿ãƒ«</h1>
        <p style={{ color: "#888", fontSize: isMobile ? 14 : 16 }}>ã‚ˆã†ã“ãã€{user?.name}ã•ã‚“</p>
      </div>
      <div style={{ display: "grid", gridTemplateColumns: isMobile ? "1fr" : "repeat(auto-fit,minmax(280px,1fr))", gap: 16 }}>
        {cards.map((c) => (
          <div key={c.tab} onClick={() => setTab(c.tab)} style={{ ...S.card, padding: isMobile ? "20px" : "28px 24px", cursor: "pointer", borderTop: `5px solid ${c.color}`, transition: "transform .15s, box-shadow .15s" }}>
            <div style={{ fontSize: isMobile ? 32 : 40, marginBottom: 14 }}>{c.icon}</div>
            <h3 style={{ fontSize: isMobile ? 16 : 18, fontWeight: 700, color: "#1a2d4a", marginBottom: 8 }}>{c.title}</h3>
            <p style={{ fontSize: 14, color: "#888", lineHeight: 1.6 }}>{c.desc}</p>
          </div>
        ))}
      </div>
      <div style={{ ...S.card, marginTop: 24, padding: "20px 24px" }}>
        <h3 style={{ fontSize: 16, fontWeight: 700, color: "#C0392B", marginBottom: 12 }}>ğŸš¨ ç·Šæ€¥é€£çµ¡å…ˆ</h3>
        <div style={{ fontSize: 15, color: "#333", lineHeight: 2.4 }}>
          é…è»Šæ‹…å½“ï¼š<a href="tel:09012139803" style={{ color: "#1B4F72", fontWeight: 600, textDecoration: "none" }}>090-1213-9803</a><br />
          å—æ³¨èª²ï¼š<a href="tel:09063018209" style={{ color: "#1B4F72", fontWeight: 600, textDecoration: "none" }}>090-6301-8209</a><br />
          æœ¬ç¤¾ / æ™‚é–“å¤–ï¼š<a href="tel:0297551380" style={{ color: "#1B4F72", fontWeight: 600, textDecoration: "none" }}>0297-55-1380</a>
        </div>
      </div>
    </div>
  );
}

/* ===== ManualViewer ===== */
function ManualViewer() {
  const [sel, setSel] = useState(null);
  const [sec, setSec] = useState(0);
  const isMobile = useIsMobile();
  if (!sel)
    return (
      <div style={{ maxWidth: 1000, margin: "0 auto", padding: isMobile ? "20px 12px" : "24px 16px" }}>
        <h2 style={{ fontSize: 20, fontWeight: 700, color: "#1a2d4a", marginBottom: 16 }}>ğŸ“„ æ‰‹é †æ›¸ä¸€è¦§</h2>
        <div style={{ display: "grid", gridTemplateColumns: isMobile ? "1fr" : "repeat(auto-fill,minmax(280px,1fr))", gap: 14 }}>
          {MANUALS.map((m) => (
            <div key={m.id} onClick={() => { setSel(m); setSec(0); }} style={{ ...S.card, padding: "20px", cursor: "pointer", borderLeft: `5px solid ${m.color}` }}>
              <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                <span style={{ fontSize: 28 }}>{m.icon}</span>
                <span style={{ fontSize: 11, color: "#888", background: "#f0f0f0", padding: "4px 10px", borderRadius: 10 }}>{m.tag}</span>
              </div>
              <div style={{ fontSize: 16, fontWeight: 700, color: "#1a2d4a", marginTop: 10 }}>{m.title}</div>
              <div style={{ fontSize: 13, color: "#aaa", marginTop: 4 }}>{m.sections.length}ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div>
            </div>
          ))}
        </div>
      </div>
    );
  return (
    <div style={{ maxWidth: 900, margin: "0 auto", padding: isMobile ? "16px 10px" : "24px 16px" }}>
      <button onClick={() => setSel(null)} style={{ background: "none", border: "none", color: "#2E86C1", cursor: "pointer", fontSize: 15, fontWeight: 600, marginBottom: 14, padding: "8px 0" }}>
        â† ä¸€è¦§ã«æˆ»ã‚‹
      </button>
      <div style={S.card}>
        <div style={{ padding: isMobile ? "16px" : "20px 24px", borderBottom: "1px solid #e0e0e0", background: `linear-gradient(135deg,${sel.color}11,${sel.color}05)` }}>
          <span style={{ fontSize: 32 }}>{sel.icon}</span>
          <h2 style={{ fontSize: isMobile ? 17 : 19, fontWeight: 700, color: "#1a2d4a", marginTop: 8 }}>{sel.title}</h2>
        </div>
        <div style={{ display: "flex", borderBottom: "1px solid #eee", overflowX: "auto", WebkitOverflowScrolling: "touch", scrollbarWidth: "none" }}>
          {sel.sections.map((s, i) => (
            <button key={i} onClick={() => setSec(i)} style={{ background: "none", border: "none", padding: isMobile ? "12px 14px" : "14px 18px", cursor: "pointer", fontSize: isMobile ? 13 : 14, fontWeight: sec === i ? 700 : 400, color: sec === i ? sel.color : "#666", borderBottom: sec === i ? `3px solid ${sel.color}` : "3px solid transparent", whiteSpace: "nowrap" }}>
              {s.title}
            </button>
          ))}
        </div>
        <div style={{ padding: isMobile ? "18px 14px" : "24px", whiteSpace: "pre-line", fontSize: isMobile ? 15 : 16, lineHeight: 2.2, color: "#333" }}>{sel.sections[sec].content}</div>
      </div>
    </div>
  );
}

/* ===== CourseViewï¼ˆå­¦ç¿’å°‚ç”¨ï¼‰ ===== */
function CourseView({ course, onBack }) {
  const c = course;
  const [sec, setSec] = useState(0);
  const isMobile = useIsMobile();
  return (
    <div style={{ maxWidth: 800, margin: "0 auto", padding: isMobile ? "16px 10px" : "24px 16px" }}>
      <button onClick={onBack} style={{ background: "none", border: "none", color: "#1B4F72", cursor: "pointer", fontSize: 15, fontWeight: 600, marginBottom: 16, padding: "8px 0" }}>
        â† ã‚³ãƒ¼ã‚¹ä¸€è¦§ã«æˆ»ã‚‹
      </button>
      <div style={S.card}>
        <div style={{ background: `linear-gradient(135deg,${c.color},${c.color}cc)`, color: "#fff", padding: isMobile ? "18px" : "24px" }}>
          <span style={{ fontSize: 36 }}>{c.icon}</span>
          <h2 style={{ fontSize: isMobile ? 18 : 20, fontWeight: 700, marginTop: 6 }}>{c.title}</h2>
          <div style={{ fontSize: 14, opacity: 0.8, marginTop: 4 }}>{c.cat} â€¢ å…¨{c.secs.length}ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div>
        </div>
        <div style={{ padding: isMobile ? "18px" : "24px" }}>
          <div style={{ display: "flex", gap: 4, marginBottom: 20 }}>
            {c.secs.map((_, i) => (
              <div key={i} onClick={() => setSec(i)} style={{ flex: 1, height: 6, borderRadius: 3, background: i <= sec ? c.color : "#e0e0e0", cursor: "pointer", transition: "background .2s" }} />
            ))}
          </div>
          <div style={{ fontSize: 13, color: c.color, fontWeight: 700, marginBottom: 6 }}>ã‚»ã‚¯ã‚·ãƒ§ãƒ³ {sec + 1}/{c.secs.length}</div>
          <h3 style={{ fontSize: isMobile ? 16 : 18, fontWeight: 700, color: "#1a2d4a", marginBottom: 16 }}>{c.secs[sec].title}</h3>
          <div style={{ fontSize: isMobile ? 15 : 16, lineHeight: 2.2, color: "#333", whiteSpace: "pre-line" }}>{c.secs[sec].body}</div>
          <div style={{ display: "flex", justifyContent: "space-between", marginTop: 24, gap: 12 }}>
            <button onClick={() => setSec(Math.max(0, sec - 1))} disabled={sec === 0} style={{ padding: "12px 24px", borderRadius: 10, border: "1px solid #ccc", background: "#fff", cursor: sec === 0 ? "default" : "pointer", opacity: sec === 0 ? 0.4 : 1, fontSize: 15 }}>
              â† å‰ã¸
            </button>
            {sec < c.secs.length - 1 ? (
              <button onClick={() => setSec(sec + 1)} style={{ padding: "12px 24px", borderRadius: 10, border: "none", background: c.color, color: "#fff", cursor: "pointer", fontSize: 15, fontWeight: 600 }}>
                æ¬¡ã¸ â†’
              </button>
            ) : (
              <button onClick={onBack} style={{ padding: "12px 24px", borderRadius: 10, border: "none", background: "#27AE60", color: "#fff", cursor: "pointer", fontSize: 15, fontWeight: 700 }}>
                âœ“ å­¦ç¿’å®Œäº†
              </button>
            )}
          </div>
        </div>
      </div>
    </div>
  );
}

/* ===== RandomTestï¼ˆãƒ©ãƒ³ãƒ€ãƒ 30å•ãƒ†ã‚¹ãƒˆï¼‰ ===== */
function RandomTest({ user, onBack, onDone }) {
  const [questions, setQuestions] = useState([]);
  const [ans, setAns] = useState({});
  const [sub, setSub] = useState(null);
  const topRef = useRef(null);
  const isMobile = useIsMobile();

  const buildQuestions = () => {
    const pool = COURSES.flatMap((c) =>
      c.quiz.map((q) => ({ ...q, courseId: c.id, courseIcon: c.icon, courseTitle: c.title, courseColor: c.color }))
    );
    for (let i = pool.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [pool[i], pool[j]] = [pool[j], pool[i]];
    }
    return pool.slice(0, TEST_Q_COUNT);
  };

  useEffect(() => { setQuestions(buildQuestions()); }, []);

  const submit = () => {
    let sc = 0;
    questions.forEach((q, i) => { if (ans[i] === q.a) sc++; });
    const pa = sc >= TEST_PASS_LINE;
    setSub({ sc, pa });
    if (onDone) onDone(sc, pa);
    topRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  const retry = () => { setAns({}); setSub(null); setQuestions(buildQuestions()); };

  if (questions.length === 0) return <div style={{ textAlign: "center", padding: 60, color: "#666", fontSize: 16 }}>å•é¡Œã‚’æº–å‚™ä¸­...</div>;

  const allOK = Object.keys(ans).length === questions.length;

  return (
    <div ref={topRef} style={{ maxWidth: 800, margin: "0 auto", padding: isMobile ? "16px 10px" : "24px 16px" }}>
      {!sub && (
        <button onClick={onBack} style={{ background: "none", border: "none", color: "#1B4F72", cursor: "pointer", fontSize: 15, fontWeight: 600, marginBottom: 16, padding: "8px 0" }}>
          â† ãƒ†ã‚¹ãƒˆã‚’ä¸­æ–­ã—ã¦æˆ»ã‚‹
        </button>
      )}
      <div style={S.card}>
        <div style={{ background: "linear-gradient(135deg,#1B4F72,#2E86C1)", color: "#fff", padding: isMobile ? "18px" : "24px" }}>
          <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
            <span style={{ fontSize: 36 }}>ğŸ“</span>
            <div>
              <h2 style={{ fontSize: isMobile ? 18 : 20, fontWeight: 700, margin: 0 }}>ç·åˆç¢ºèªãƒ†ã‚¹ãƒˆ</h2>
              <div style={{ fontSize: isMobile ? 12 : 14, opacity: 0.8, marginTop: 4 }}>
                ãƒ©ãƒ³ãƒ€ãƒ {TEST_Q_COUNT}å• â€¢ åˆæ ¼: {TEST_PASS_LINE}å•ä»¥ä¸Šï¼ˆ{PASS_RATE}%ï¼‰
              </div>
            </div>
          </div>
          <div style={{ fontSize: 14, marginTop: 10, opacity: 0.7 }}>å—é¨“è€…: {user.empId} {user.name}</div>
        </div>

        <div style={{ padding: isMobile ? "16px" : "24px" }}>
          {sub && (
            <div style={{ background: sub.pa ? "#d4edda" : "#f8d7da", borderRadius: 14, padding: isMobile ? "18px" : "24px", marginBottom: 24, border: "2px solid " + (sub.pa ? "#28a745" : "#dc3545"), textAlign: "center" }}>
              <div style={{ fontSize: 44, marginBottom: 8 }}>{sub.pa ? "ğŸ‰" : "ğŸ“š"}</div>
              <div style={{ fontSize: isMobile ? 18 : 22, fontWeight: 700, color: sub.pa ? "#155724" : "#721c24" }}>
                {sub.pa ? "åˆæ ¼ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼" : "ä¸åˆæ ¼ â€” å†å­¦ç¿’ã—ã¦ãã ã•ã„"}
              </div>
              <div style={{ fontSize: 18, marginTop: 8, color: "#555" }}>
                {sub.sc}/{TEST_Q_COUNT}å•æ­£è§£ï¼ˆ{Math.round((sub.sc / TEST_Q_COUNT) * 100)}%ï¼‰
              </div>
              <div style={{ display: "flex", gap: 12, justifyContent: "center", marginTop: 20, flexWrap: "wrap" }}>
                <button onClick={onBack} style={{ padding: "14px 28px", borderRadius: 10, border: "1px solid #ccc", background: "#fff", cursor: "pointer", fontSize: 15, fontWeight: 600 }}>
                  ä¸€è¦§ã«æˆ»ã‚‹
                </button>
                <button onClick={retry} style={{ padding: "14px 28px", borderRadius: 10, border: "none", background: "#2E86C1", color: "#fff", cursor: "pointer", fontSize: 15, fontWeight: 700 }}>
                  ğŸ”„ æ–°ã—ã„å•é¡Œã§å†æŒ‘æˆ¦
                </button>
              </div>
            </div>
          )}

          {!sub && (
            <div style={{ background: "#f0f2f5", borderRadius: 10, padding: "12px 16px", marginBottom: 20, display: "flex", alignItems: "center", gap: 12, position: "sticky", top: isMobile ? 85 : 95, zIndex: 10 }}>
              <div style={{ fontSize: 14, color: "#666", whiteSpace: "nowrap" }}>å›ç­”</div>
              <div style={{ flex: 1, height: 8, background: "#ddd", borderRadius: 4, overflow: "hidden" }}>
                <div style={{ width: (Object.keys(ans).length / TEST_Q_COUNT) * 100 + "%", height: "100%", background: allOK ? "#27AE60" : "#2E86C1", borderRadius: 4, transition: "width .3s" }} />
              </div>
              <div style={{ fontSize: 14, fontWeight: 700, color: allOK ? "#27AE60" : "#666" }}>
                {Object.keys(ans).length}/{TEST_Q_COUNT}
              </div>
            </div>
          )}

          {questions.map((q, qi) => (
            <div
              key={qi}
              style={{
                background: "#f9f9f9", borderRadius: 14, padding: isMobile ? "16px" : "20px", marginBottom: 14,
                border: sub
                  ? ans[qi] === q.a ? "2px solid #27AE60" : ans[qi] !== undefined ? "2px solid #E74C3C" : "1px solid #e0e0e0"
                  : "1px solid #e0e0e0",
              }}
            >
              <div style={{ fontSize: 12, color: q.courseColor, fontWeight: 700, marginBottom: 8 }}>
                {q.courseIcon} {q.courseTitle}
              </div>
              <div style={{ fontSize: isMobile ? 15 : 16, fontWeight: 700, color: "#1a2d4a", marginBottom: 14, lineHeight: 1.5 }}>
                Q{qi + 1}. {q.q}
              </div>
              {q.o.map((opt, oi) => {
                const selected = ans[qi] === oi;
                const isOk = sub && oi === q.a;
                const isNg = sub && selected && oi !== q.a;
                return (
                  <div
                    key={oi}
                    onClick={() => !sub && setAns((p) => ({ ...p, [qi]: oi }))}
                    style={{
                      padding: isMobile ? "12px 14px" : "14px 16px",
                      borderRadius: 10, marginBottom: 8,
                      fontSize: isMobile ? 15 : 16,
                      cursor: sub ? "default" : "pointer",
                      border: "2px solid " + (isOk ? "#27AE60" : isNg ? "#E74C3C" : selected ? "#2E86C1" : "#e0e0e0"),
                      background: isOk ? "rgba(39,174,96,0.1)" : isNg ? "rgba(231,76,60,0.1)" : selected ? "rgba(46,134,193,0.1)" : "#fff",
                      color: "#333", transition: "all .15s", lineHeight: 1.5,
                      WebkitTapHighlightColor: "transparent",
                    }}
                  >
                    <span style={{ marginRight: 10, fontWeight: 700, fontSize: 18, color: isOk ? "#27AE60" : isNg ? "#E74C3C" : selected ? "#2E86C1" : "#bbb" }}>
                      {isOk ? "âœ“" : isNg ? "âœ—" : selected ? "â—" : "â—‹"}
                    </span>
                    {opt}
                  </div>
                );
              })}
            </div>
          ))}

          {!sub && (
            <button
              onClick={submit}
              disabled={!allOK}
              style={{
                width: "100%", padding: "18px", borderRadius: 14, border: "none",
                background: allOK ? "linear-gradient(135deg,#1B4F72,#2E86C1)" : "#ccc",
                color: "#fff", fontSize: 18, fontWeight: 700,
                cursor: allOK ? "pointer" : "default", marginTop: 8,
                position: "sticky", bottom: 12, zIndex: 10,
                boxShadow: allOK ? "0 4px 20px rgba(27,79,114,0.4)" : "none",
              }}
            >
              {allOK ? "ãƒ†ã‚¹ãƒˆã‚’æå‡ºã™ã‚‹" : `ã‚ã¨${TEST_Q_COUNT - Object.keys(ans).length}å•æœªå›ç­”`}
            </button>
          )}
        </div>
      </div>
    </div>
  );
}

/* ===== ELearning ===== */
function ELearning({ user }) {
  const [selC, setSelC] = useState(null);
  const [showTest, setShowTest] = useState(false);
  const [prog, setProg] = useState({});
  const [testHist, setTestHist] = useState([]);
  const [loaded, setLoaded] = useState(false);
  const isMobile = useIsMobile();

  useEffect(() => {
    let c = false;
    if (!user) { setLoaded(true); return; }
    (async () => {
      try { const r = await stor.get(`prog:${user.empId}`); if (!c && r?.value) setProg(JSON.parse(r.value)); } catch {}
      try { const r = await stor.get(`testHist:${user.empId}`); if (!c && r?.value) setTestHist(JSON.parse(r.value)); } catch {}
      if (!c) setLoaded(true);
    })();
    return () => { c = true; };
  }, [user]);

  const markLearned = async (cid) => {
    const np = { ...prog, [cid]: { ...prog[cid], learned: true, learnedAt: new Date().toISOString() } };
    setProg(np);
    try { await stor.set(`prog:${user.empId}`, JSON.stringify(np)); } catch {}
  };

  const onTestDone = async (sc, pa) => {
    const rec = { empId: user.empId, name: user.name, score: sc, totalQ: TEST_Q_COUNT, pct: Math.round((sc / TEST_Q_COUNT) * 100), passed: pa, date: new Date().toISOString() };
    try { await stor.set(`res:${user.empId}:unified:${Date.now()}`, JSON.stringify({ ...rec, courseId: "unified", courseName: "ç·åˆç¢ºèªãƒ†ã‚¹ãƒˆ" })); } catch {}
    const nh = [rec, ...testHist].slice(0, 20);
    setTestHist(nh);
    try { await stor.set(`testHist:${user.empId}`, JSON.stringify(nh)); } catch {}
  };

  if (!loaded) return <div style={{ textAlign: "center", padding: 60, color: "#666", fontSize: 16 }}>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (showTest) return <RandomTest user={user} onBack={() => setShowTest(false)} onDone={onTestDone} />;
  if (selC) {
    const c = COURSES.find((x) => x.id === selC);
    return <CourseView course={c} onBack={() => { markLearned(selC); setSelC(null); }} />;
  }

  const learnedCount = Object.values(prog).filter((p) => p.learned).length;
  const learnPct = Math.round((learnedCount / COURSES.length) * 100);
  const lastTest = testHist[0];
  const bestTest = testHist.length > 0 ? testHist.reduce((b, t) => (t.score > b.score ? t : b), testHist[0]) : null;
  const cats = [...new Set(COURSES.map((c) => c.cat))];

  return (
    <div style={{ maxWidth: 1100, margin: "0 auto", padding: isMobile ? "16px 10px" : "24px 16px" }}>
      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ãƒãƒŠãƒ¼ */}
      <div style={{ background: "linear-gradient(135deg,#1a2d4a,#2E86C1)", borderRadius: 16, padding: isMobile ? "18px" : "24px", color: "#fff", marginBottom: 24 }}>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", flexWrap: "wrap", gap: 16 }}>
          <div>
            <div style={{ fontSize: 13, opacity: 0.7 }}>å—è¬›è€…</div>
            <div style={{ fontSize: isMobile ? 17 : 20, fontWeight: 700 }}>{user.empId} {user.name}</div>
          </div>
          <div style={{ display: "flex", gap: 20, alignItems: "center" }}>
            <div style={{ textAlign: "center" }}>
              <div style={{ fontSize: isMobile ? 22 : 28, fontWeight: 700 }}>{learnedCount}/{COURSES.length}</div>
              <div style={{ fontSize: 12, opacity: 0.7 }}>å­¦ç¿’æ¸ˆã¿</div>
            </div>
            <div style={{ width: 56, height: 56, borderRadius: "50%", border: "4px solid rgba(255,255,255,0.3)", display: "flex", alignItems: "center", justifyContent: "center", fontWeight: 700, fontSize: 15 }}>
              {learnPct}%
            </div>
          </div>
        </div>
      </div>

      {/* ãƒ†ã‚¹ãƒˆé–‹å§‹ã‚¨ãƒªã‚¢ */}
      <div style={{ background: "#fff", borderRadius: 16, border: "2px solid #2E86C1", padding: isMobile ? "18px" : "24px", marginBottom: 24 }}>
        <div style={{ display: "flex", alignItems: "center", justifyContent: "space-between", flexWrap: "wrap", gap: 16 }}>
          <div style={{ flex: 1, minWidth: 200 }}>
            <div style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 8 }}>
              <span style={{ fontSize: 28 }}>ğŸ“</span>
              <h3 style={{ fontSize: isMobile ? 16 : 18, fontWeight: 700, color: "#1a2d4a", margin: 0 }}>ç·åˆç¢ºèªãƒ†ã‚¹ãƒˆ</h3>
            </div>
            <div style={{ fontSize: 14, color: "#666", lineHeight: 1.8 }}>
              å…¨{COURSES.length}ã‚³ãƒ¼ã‚¹ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ {TEST_Q_COUNT}å•<br />
              æ¯å›å‡ºé¡ŒãŒå¤‰ã‚ã‚Šã¾ã™ â€¢ åˆæ ¼{PASS_RATE}%
            </div>
            {lastTest && (
              <div style={{ fontSize: 13, color: "#888", marginTop: 8 }}>
                å‰å›: {new Date(lastTest.date).toLocaleDateString("ja-JP")} â€”
                <span style={{ color: lastTest.passed ? "#27AE60" : "#E74C3C", fontWeight: 700 }}>
                  {" "}{lastTest.score}/{TEST_Q_COUNT}ï¼ˆ{lastTest.pct}%ï¼‰{lastTest.passed ? " åˆæ ¼" : " ä¸åˆæ ¼"}
                </span>
                {bestTest && bestTest.score !== lastTest.score && (
                  <span style={{ marginLeft: 8, color: "#2E86C1" }}>æœ€é«˜: {bestTest.score}/{TEST_Q_COUNT}</span>
                )}
              </div>
            )}
          </div>
          <button
            onClick={() => setShowTest(true)}
            style={{
              padding: isMobile ? "14px 28px" : "18px 40px", borderRadius: 14, border: "none",
              background: "linear-gradient(135deg,#1B4F72,#2E86C1)", color: "#fff",
              fontSize: isMobile ? 16 : 18, fontWeight: 700, cursor: "pointer",
              boxShadow: "0 4px 16px rgba(46,134,193,0.3)", whiteSpace: "nowrap",
              width: isMobile ? "100%" : "auto",
            }}
          >
            ğŸš€ ãƒ†ã‚¹ãƒˆé–‹å§‹
          </button>
        </div>
      </div>

      {/* ãƒ†ã‚¹ãƒˆå±¥æ­´ */}
      {testHist.length > 0 && (
        <div style={{ background: "#fff", borderRadius: 14, border: "1px solid #e0e0e0", padding: isMobile ? "14px" : "20px", marginBottom: 24 }}>
          <div style={{ fontSize: 15, fontWeight: 700, color: "#1a2d4a", marginBottom: 12 }}>
            ğŸ“Š ãƒ†ã‚¹ãƒˆå±¥æ­´ï¼ˆç›´è¿‘{Math.min(testHist.length, 5)}å›ï¼‰
          </div>
          <div style={{ display: "flex", gap: 10, flexWrap: "wrap" }}>
            {testHist.slice(0, 5).map((t, i) => (
              <div key={i} style={{ padding: "10px 16px", borderRadius: 10, fontSize: isMobile ? 13 : 14, background: t.passed ? "rgba(39,174,96,0.08)" : "rgba(231,76,60,0.08)", border: "1.5px solid " + (t.passed ? "#27AE60" : "#E74C3C"), color: t.passed ? "#155724" : "#721c24" }}>
                {new Date(t.date).toLocaleDateString("ja-JP")} â€” {t.score}/{TEST_Q_COUNT}ï¼ˆ{t.pct}%ï¼‰{t.passed ? " âœ“åˆæ ¼" : " âœ—ä¸åˆæ ¼"}
              </div>
            ))}
          </div>
        </div>
      )}

      {/* ã‚³ãƒ¼ã‚¹å­¦ç¿’ä¸€è¦§ */}
      <div style={{ fontSize: 18, fontWeight: 700, color: "#1a2d4a", marginBottom: 8 }}>ğŸ“– å­¦ç¿’æ•™æ</div>
      <div style={{ fontSize: 14, color: "#888", marginBottom: 20 }}>ãƒ†ã‚¹ãƒˆå‰ã«å„ã‚³ãƒ¼ã‚¹ã®æ•™æã‚’èª­ã‚“ã§å­¦ç¿’ã—ã¦ãã ã•ã„ã€‚</div>
      {cats.map((cat) => (
        <div key={cat} style={{ marginBottom: 24 }}>
          <div style={{ fontSize: 14, fontWeight: 700, color: "#555", marginBottom: 10, padding: "6px 0", borderBottom: "2px solid #e0e0e0" }}>{cat}</div>
          <div style={{ display: "grid", gridTemplateColumns: isMobile ? "1fr" : "repeat(auto-fill,minmax(280px,1fr))", gap: 14 }}>
            {COURSES.filter((c) => c.cat === cat).map((c) => {
              const learned = prog[c.id]?.learned;
              return (
                <div key={c.id} onClick={() => setSelC(c.id)} style={{ background: "#fff", borderRadius: 14, padding: "20px", cursor: "pointer", border: "1px solid #e0e0e0", position: "relative", overflow: "hidden", WebkitTapHighlightColor: "transparent" }}>
                  <div style={{ position: "absolute", top: 0, left: 0, right: 0, height: 4, background: c.color }} />
                  <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
                    <span style={{ fontSize: 30 }}>{c.icon}</span>
                    <div style={{ flex: 1, minWidth: 0 }}>
                      <div style={{ fontSize: 16, fontWeight: 700, color: "#1a2d4a" }}>{c.title}</div>
                      <div style={{ fontSize: 13, color: "#888", marginTop: 2 }}>{c.secs.length}ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â€¢ {c.quiz.length}å•</div>
                    </div>
                    {learned && <div style={{ background: "#d4edda", color: "#155724", fontSize: 12, fontWeight: 700, padding: "4px 10px", borderRadius: 8, whiteSpace: "nowrap" }}>å­¦ç¿’æ¸ˆ</div>}
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      ))}
    </div>
  );
}

/* ===== Chatbotï¼ˆãƒ­ãƒ¼ã‚«ãƒ«KBå¿œç­” + APIå¯¾å¿œï¼‰ ===== */
function Chatbot() {
  const [msgs, setMsgs] = useState([
    { role: "assistant", content: "ã“ã‚“ã«ã¡ã¯ï¼ç‰©æµéƒ¨AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚\næ‰‹é †æ›¸ãƒ»ç·Šæ€¥é€£çµ¡å…ˆãƒ»KYTãƒ»æ³•ä»¤ãªã©ä½•ã§ã‚‚èã„ã¦ãã ã•ã„ã€‚" },
  ]);
  const [input, setInput] = useState("");
  const [loading, setLoading] = useState(false);
  const btm = useRef(null);
  const isMobile = useIsMobile();
  useEffect(() => { btm.current?.scrollIntoView({ behavior: "smooth" }); }, [msgs]);

  /* ãƒ­ãƒ¼ã‚«ãƒ«KBãƒãƒƒãƒãƒ³ã‚°ï¼ˆAPIä¸è¦ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰ */
  const localAnswer = (q) => {
    const kw = [
      { keys: ["å‡ºç™ºå‰", "5ç‚¹", "äº”ç‚¹", "å‡ºç™º"], ans: "ã€å‡ºç™ºå‰5ç‚¹ç¢ºèªã€‘\nâ‘ ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´ç¢ºèª\nâ‘¡ãƒ–ãƒ¼ãƒ æ ¼ç´ç¢ºèª\nâ‘¢è£½å“è·ç· ã‚ç¢ºèª\nâ‘£éƒ¨æè·ç· ã‚ç¢ºèª\nâ‘¤ä¸å…·åˆç®‡æ‰€ã®ä¿®æ­£\n\nä¸å…·åˆã‚’èªè­˜ã—ãŸã¾ã¾ã®å‡ºç™ºã¯ç¦æ­¢ã§ã™ã€‚æŒ‡å·®ã—å‘¼ç§°ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚" },
      { keys: ["é€€å‡ºå‰", "é€€å‡º"], ans: "ã€é€€å‡ºå‰5ç‚¹ç¢ºèªã€‘\nâ‘ ãƒ–ãƒ¼ãƒ æ ¼ç´\nâ‘¡ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´\nâ‘¢ãƒ¯ã‚¤ãƒ¤ãƒ¼ä¹±å·»ãªã—\nâ‘£ãƒ•ãƒƒã‚¯æ ¼ç´\nâ‘¤PTOè§£é™¤\n\nå‘¼ç§°ï¼šã€Œãƒ–ãƒ¼ãƒ æ ¼ç´ã‚ˆã—ï¼ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æ ¼ç´ã‚ˆã—ï¼ãƒ¯ã‚¤ãƒ¤ãƒ¼ä¹±å·»ãªã—ã‚ˆã—ï¼ãƒ•ãƒƒã‚¯æ ¼ç´ã‚ˆã—ï¼PTOè§£é™¤ã‚ˆã—ï¼ã€" },
      { keys: ["äº‹æ•…", "èµ·ã", "ç™ºç”Ÿ"], ans: "ã€äº‹æ•…ç™ºç”Ÿæ™‚ã®3åŸå‰‡ã€‘\nâ‘ å®‰å…¨ç¢ºä¿ï¼ˆäºŒæ¬¡ç½å®³ã®é˜²æ­¢ï¼‰\nâ‘¡æ•‘è­·ãƒ»é€šå ±ï¼ˆ119ç•ªãƒ»110ç•ªï¼‰\nâ‘¢ä¼šç¤¾é€£çµ¡ï¼ˆé…è»Šæ‹…å½“ï¼š090-1213-9803ï¼‰\n\nã€çµ¶å¯¾ç¦æ­¢ã€‘ç¾å ´é›¢è„±ãƒ»å ±å‘Šéš è”½ãƒ»ç¤ºè«‡äº¤æ¸‰ãƒ»è²¬ä»»ã‚’èªã‚ã‚‹ç™ºè¨€ãƒ»SNSæŠ•ç¨¿" },
      { keys: ["é›»ç·š", "æ„Ÿé›»", "åˆ‡æ–­"], ans: "ã€é›»ç·šåˆ‡æ–­æ™‚ã®å¯¾å¿œã€‘\nâ‘ çµ¶å¯¾ã«è»Šä¸¡ã‹ã‚‰é™ã‚Šãªã„ï¼ˆæ„Ÿé›»ã®å±é™ºï¼‰\nâ‘¡110ç•ªã«é€£çµ¡\nâ‘¢é…è»Šæ‹…å½“ã«é€£çµ¡ï¼ˆ090-1213-9803ï¼‰\nâ‘£æ±äº¬é›»åŠ›ã«é€£çµ¡ï¼ˆ0120-995-007ï¼‰\nâ‘¤è»Šå†…ã§å¾…æ©Ÿ" },
      { keys: ["é€£çµ¡å…ˆ", "é›»è©±", "ç•ªå·"], ans: "ã€ç·Šæ€¥é€£çµ¡å…ˆã€‘\né…è»Šæ‹…å½“è€…ï¼š090-1213-9803\nèŒ¨åŸå·¥å ´å—æ³¨èª²ï¼š090-6301-8209ï¼ˆ8:00ã€œ17:00ï¼‰\nãƒ¡ãƒ¼ã‚¯ã‚¹æœ¬ç¤¾ï¼š0297-55-1380\næ™‚é–“å¤–ï¼š0297-55-1380\næ±äº¬é›»åŠ›ï¼š0120-995-007\nNTTï¼š0120-444-113" },
      { keys: ["æ™‚é–“å¤–", "å¤œé–“", "ä¼‘æ—¥"], ans: "ã€æ™‚é–“å¤–é€£çµ¡å…ˆã€‘\n0297-55-1380ï¼ˆ17:00ã€œç¿Œ8:00ãƒ»åœŸæ—¥ç¥ï¼‰\næœ¬ç¤¾ã¨åŒã˜ç•ªå·ã§è‡ªå‹•è»¢é€ã•ã‚Œã¾ã™ã€‚" },
      { keys: ["æ”¹å–„åŸºæº–", "æ‹˜æŸ", "é‹è»¢æ™‚é–“"], ans: "ã€æ”¹å–„åŸºæº–å‘Šç¤ºã€‘\nãƒ»1æ—¥ã®æ‹˜æŸæ™‚é–“ï¼šåŸå‰‡13æ™‚é–“ä»¥å†…ï¼ˆä¸Šé™16æ™‚é–“ï¼‰\nãƒ»1ã‹æœˆï¼šåŸå‰‡284æ™‚é–“\nãƒ»é€£ç¶šé‹è»¢ï¼š4æ™‚é–“ä»¥å†…ã«30åˆ†ä»¥ä¸Šä¼‘æ†©\nãƒ»å‹¤å‹™é–“ä¼‘æ¯ï¼šç¶™ç¶š11æ™‚é–“ä»¥ä¸ŠãŒåŸºæœ¬" },
      { keys: ["ç†±ä¸­ç—‡", "æš‘ã•", "WBGT"], ans: "ã€ç†±ä¸­ç—‡äºˆé˜²ã€‘\nãƒ»WBGT31ä»¥ä¸Šã¯åŸå‰‡å¤–ä½œæ¥­ä¸­æ­¢\nãƒ»1æ™‚é–“ã«ã‚³ãƒƒãƒ—2ã€œ3æ¯ã®æ°´åˆ†è£œçµ¦\nãƒ»è»½åº¦ï¼ˆã‚ã¾ã„ï¼‰â†’æ¶¼ã—ã„å ´æ‰€ã§æ°´åˆ†è£œçµ¦\nãƒ»é‡åº¦ï¼ˆæ„è­˜éšœå®³ï¼‰â†’ã™ãã«119ç•ªé€šå ±" },
      { keys: ["ã‚¯ãƒ¬ãƒ¼ãƒ³", "é¢¨é€Ÿ", "ä½œæ¥­ä¸­æ­¢"], ans: "ã€ã‚¯ãƒ¬ãƒ¼ãƒ³ä½œæ¥­ã€‘\nãƒ»é¢¨é€Ÿ10m/sä»¥ä¸Šã¯ä½œæ¥­ä¸­æ­¢\nãƒ»ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼æœ€å¤§å¼µã‚Šå‡ºã—å¿…é ˆï¼ˆç‰‡å´ç¦æ­¢ï¼‰\nãƒ»æ•·æ¿å¿…ãšè¨­ç½®\nãƒ»Uå­—æºè“‹ä¸Šã¸ã®è¨­ç½®ç¦æ­¢\nãƒ»åŠã‚Šè·ã®ä¸‹ã«ç«‹å…¥ç¦æ­¢" },
      { keys: ["ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼"], ans: "ã€ã‚¢ã‚¦ãƒˆãƒªã‚¬ãƒ¼ã€‘\nãƒ»æœ€å¤§ä½ç½®ã¾ã§å¼µã‚Šå‡ºã—å¿…é ˆ\nãƒ»ç‰‡å´ã®ã¿ã®ä½¿ç”¨ã¯ç¦æ­¢\nãƒ»Uå­—æºè“‹ã®ä¸Šã¸ã®è¨­ç½®ç¦æ­¢\nãƒ»å¿…ãšæ•·æ¿ã‚’è¨­ç½®\nãƒ»åœ°ç›¤ã‚’ç¢ºèªã—ã¦ã‹ã‚‰è¨­ç½®" },
      { keys: ["KYT", "å±é™ºäºˆçŸ¥"], ans: "ã€KYT 4ãƒ©ã‚¦ãƒ³ãƒ‰æ³•ã€‘\nç¬¬1Rï¼šå±é™ºã®æ´—ã„å‡ºã—ï¼ˆã©ã‚“ãªå±é™ºãŒã‚ã‚‹ã‹ï¼‰\nç¬¬2Rï¼šå±é™ºã®çµã‚Šè¾¼ã¿ï¼ˆæœ€ã‚‚é‡è¦ãªå±é™ºã¯ï¼‰\nç¬¬3Rï¼šå¯¾ç­–ã®ç«‹æ¡ˆï¼ˆã‚ãªãŸãªã‚‰ã©ã†ã™ã‚‹ï¼‰\nç¬¬4Rï¼šè¡Œå‹•ç›®æ¨™ã®è¨­å®šï¼ˆæŒ‡å·®ã—å‘¼ç§°é …ç›®ã‚’æ±ºå®šï¼‰" },
      { keys: ["é£²é…’", "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«", "ãƒ“ãƒ¼ãƒ«"], ans: "ã€é£²é…’ã¨é‹è»¢ã€‘\nãƒ»ãƒ“ãƒ¼ãƒ«ä¸­ç“¶1æœ¬ï¼åˆ†è§£ã«ç´„3ã€œ4æ™‚é–“\nãƒ»3æœ¬ï¼ç´„9ã€œ12æ™‚é–“ã‹ã‹ã‚Šã¾ã™\nãƒ»ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯ã¯0.00mg/LãŒåŸºæº–\nãƒ»å°‘é‡ã§ã‚‚ç¿Œæœã«æ®‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™" },
      { keys: ["ã‚ãŠã‚Š", "ç…½ã‚Š"], ans: "ã€ã‚ãŠã‚Šé‹è»¢ã‚’å—ã‘ãŸå ´åˆã€‘\næŒ‘ç™ºã«ä¹—ã‚‰ãšå®‰å…¨ãªå ´æ‰€ã«ç§»å‹•ã—ã€110ç•ªé€šå ±ã—ã¦ãã ã•ã„ã€‚" },
      { keys: ["ç©è¾¼", "è·ç· ã‚", "ãƒ©ãƒƒã‚·ãƒ³ã‚°"], ans: "ã€ç©è¾¼ãƒ»è·ç· ã‚ã€‘\nãƒ»é…é€é †ç•ªã‚’è€ƒæ…®ã—ã¦ç©è¾¼\nãƒ»é‡å¿ƒã‚’ä½ãåã‚Šãªã\nãƒ»ãƒ©ãƒƒã‚·ãƒ³ã‚°ãƒ™ãƒ«ãƒˆæœ€ä½2æœ¬ä»¥ä¸Š\nãƒ»è£½å“é–“ã«è§’å½“ã¦ã‚’å…¥ã‚Œã‚‹\nãƒ»ã¯ã¿å‡ºã—éƒ¨ã«èµ¤ã„å¸ƒ" },
      { keys: ["ã‚¹ã‚¿ãƒƒãƒ‰ãƒ¬ã‚¹", "å†¬", "å‡çµ"], ans: "ã€å†¬å­£å¯¾ç­–ã€‘\nãƒ»ã‚¹ã‚¿ãƒƒãƒ‰ãƒ¬ã‚¹ã‚¿ã‚¤ãƒ¤ã¯12æœˆã€œ3æœˆå¿…é ˆ\nãƒ»å‡çµæ³¨æ„ç®‡æ‰€ï¼šæ©‹ã®ä¸Šãƒ»ãƒˆãƒ³ãƒãƒ«å‡ºå…¥å£ãƒ»æ—¥é™°\nãƒ»æ€¥ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ»æ€¥ãƒãƒ³ãƒ‰ãƒ«ç¦æ­¢" },
    ];
    const ql = q.toLowerCase();
    for (const item of kw) {
      if (item.keys.some((k) => ql.includes(k))) return item.ans;
    }
    return null;
  };

  const send = async (text) => {
    const q = text || input.trim();
    if (!q || loading) return;
    setInput("");
    const nm = [...msgs, { role: "user", content: q }];
    setMsgs(nm);
    setLoading(true);

    /* ã¾ãšãƒ­ãƒ¼ã‚«ãƒ«KBã§å›ç­”ã‚’è©¦ã¿ã‚‹ */
    const local = localAnswer(q);
    if (local) {
      setMsgs((p) => [...p, { role: "assistant", content: local }]);
      setLoading(false);
      return;
    }

    /* ãƒ­ãƒ¼ã‚«ãƒ«KBã«ãƒãƒƒãƒã—ãªã„å ´åˆã¯APIå‘¼ã³å‡ºã—ï¼ˆåˆ©ç”¨å¯èƒ½ãªå ´åˆï¼‰ */
    try {
      const res = await fetch("https://api.anthropic.com/v1/messages", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          model: "claude-sonnet-4-20250514",
          max_tokens: 1000,
          system: KB,
          messages: nm.filter((m) => m.role !== "system").slice(-10).map((m) => ({ role: m.role, content: m.content })),
        }),
      });
      const data = await res.json();
      const reply = data.content?.find((c) => c.type === "text")?.text || "ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚";
      setMsgs((p) => [...p, { role: "assistant", content: reply }]);
    } catch {
      /* APIå¤±æ•—æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ */
      setMsgs((p) => [
        ...p,
        { role: "assistant", content: "ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚è³ªå•ã®å†…å®¹ã«åˆè‡´ã™ã‚‹æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\n\nã‚ˆãã‚ã‚‹è³ªå•ã‚’ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰é¸ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚\n\nç·Šæ€¥æ™‚ã¯é…è»Šæ‹…å½“ï¼ˆ090-1213-9803ï¼‰ã¾ã§ãŠé›»è©±ãã ã•ã„ã€‚" },
      ]);
    }
    setLoading(false);
  };

  return (
    <div style={{ maxWidth: 800, margin: "0 auto", padding: isMobile ? "8px" : "16px", height: "calc(100vh - 130px)", display: "flex", flexDirection: "column" }}>
      <div style={{ ...S.card, flex: 1, display: "flex", flexDirection: "column" }}>
        <div style={{ padding: "16px 20px", borderBottom: "1px solid #e0e0e0", display: "flex", alignItems: "center", gap: 12 }}>
          <span style={{ fontSize: 28 }}>ğŸ¤–</span>
          <div>
            <div style={{ fontSize: 16, fontWeight: 700, color: "#1a2d4a" }}>ç‰©æµéƒ¨ AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</div>
            <div style={{ fontSize: 12, color: "#27AE60" }}>â— æ‰‹é †æ›¸ãƒ»KYTãƒ»æ³•ä»¤ã‚’å­¦ç¿’æ¸ˆã¿</div>
          </div>
        </div>
        <div style={{ flex: 1, overflowY: "auto", padding: isMobile ? "12px" : "16px 20px", display: "flex", flexDirection: "column", gap: 12 }}>
          {msgs.map((m, i) => (
            <div key={i} style={{ display: "flex", justifyContent: m.role === "user" ? "flex-end" : "flex-start" }}>
              <div style={{
                maxWidth: "85%", padding: "14px 18px", borderRadius: 16,
                fontSize: 15, lineHeight: 1.9, whiteSpace: "pre-line",
                background: m.role === "user" ? "#1B4F72" : "#f0f2f5",
                color: m.role === "user" ? "#fff" : "#333",
                borderBottomRightRadius: m.role === "user" ? 4 : 16,
                borderBottomLeftRadius: m.role === "user" ? 16 : 4,
              }}>
                {m.content}
              </div>
            </div>
          ))}
          {loading && (
            <div style={{ display: "flex" }}>
              <div style={{ padding: "14px 18px", borderRadius: 16, background: "#f0f2f5", fontSize: 15, color: "#888", borderBottomLeftRadius: 4 }}>
                è€ƒãˆã¦ã„ã¾ã™...
              </div>
            </div>
          )}
          <div ref={btm} />
        </div>
        <div style={{ padding: isMobile ? "8px 10px" : "10px 14px", borderTop: "1px solid #eee", display: "flex", gap: 8, overflowX: "auto", WebkitOverflowScrolling: "touch", scrollbarWidth: "none" }}>
          {SUGGESTIONS.map((s) => (
            <button key={s} onClick={() => send(s)} style={{ padding: "8px 14px", borderRadius: 20, border: "1.5px solid #2E86C1", background: "#fff", color: "#2E86C1", fontSize: 13, cursor: "pointer", whiteSpace: "nowrap", fontWeight: 600, WebkitTapHighlightColor: "transparent" }}>
              {s}
            </button>
          ))}
        </div>
        <div style={{ padding: isMobile ? "10px" : "14px", borderTop: "1px solid #e0e0e0", display: "flex", gap: 10 }}>
          <input
            value={input}
            onChange={(e) => setInput(e.target.value)}
            onKeyDown={(e) => e.key === "Enter" && !e.shiftKey && send()}
            placeholder="è³ªå•ã‚’å…¥åŠ›..."
            style={{ flex: 1, padding: "14px 16px", borderRadius: 14, border: "2px solid #ddd", fontSize: 16, outline: "none" }}
          />
          <button onClick={() => send()} disabled={!input.trim() || loading} style={{ ...S.btn(input.trim() && !loading ? "#1B4F72" : "#ccc"), padding: "14px 24px", fontSize: 16 }}>
            é€ä¿¡
          </button>
        </div>
      </div>
    </div>
  );
}

/* ===== AdminPanel ===== */
function AdminPanel() {
  const [auth, setAuth] = useState(false);
  const [pw, setPw] = useState("");
  const [results, setResults] = useState([]);
  const [view, setView] = useState("dashboard");
  const [ansSec, setAnsSec] = useState(0);
  const isMobile = useIsMobile();

  const login = () => {
    if (pw === ADMIN_PASS) setAuth(true);
    else alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
  };

  const loadResults = useCallback(async () => {
    try {
      const r = await stor.list("res:");
      const all = [];
      if (r?.keys) {
        for (const k of r.keys) {
          try { const d = await stor.get(k); if (d?.value) all.push(JSON.parse(d.value)); } catch {}
        }
      }
      all.sort((a, b) => new Date(b.date) - new Date(a.date));
      setResults(all);
    } catch {}
  }, []);

  useEffect(() => { if (auth) loadResults(); }, [auth, loadResults]);

  if (!auth)
    return (
      <div style={{ maxWidth: 420, margin: "60px auto", padding: 20 }}>
        <div style={{ ...S.card, padding: "36px 28px" }}>
          <div style={{ textAlign: "center", marginBottom: 24 }}>
            <div style={{ fontSize: 44 }}>ğŸ”</div>
            <h2 style={{ fontSize: 20, fontWeight: 700, color: "#1a2d4a", marginTop: 10 }}>ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</h2>
          </div>
          <input type="password" value={pw} onChange={(e) => setPw(e.target.value)} onKeyDown={(e) => e.key === "Enter" && login()} placeholder="ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" style={{ ...S.input, marginBottom: 16 }} />
          <button onClick={login} style={{ ...S.btn("#C0392B"), width: "100%", padding: "16px", fontSize: 17 }}>ãƒ­ã‚°ã‚¤ãƒ³</button>
        </div>
      </div>
    );

  const uniq = [...new Map(results.map((r) => [r.empId, r])).values()];
  const passC = results.filter((r) => r.passed).length;

  return (
    <div style={{ maxWidth: 1100, margin: "0 auto", padding: isMobile ? "16px 10px" : "24px 16px" }}>
      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 20, flexWrap: "wrap", gap: 10 }}>
        <h2 style={{ fontSize: 20, fontWeight: 700, color: "#1a2d4a" }}>ğŸ” ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
        <button onClick={loadResults} style={{ ...S.btn("#2471A3"), padding: "10px 18px", fontSize: 14 }}>ğŸ”„ æ›´æ–°</button>
      </div>
      <div style={{ display: "flex", gap: 8, marginBottom: 20, flexWrap: "wrap" }}>
        {[
          { k: "dashboard", l: "ğŸ“Š æ¦‚è¦" },
          { k: "results", l: "ğŸ“‹ å—é¨“å±¥æ­´" },
          { k: "answers", l: "ğŸ” å›ç­”é›†" },
          { k: "guide", l: "ğŸ“ å¤‰æ›´ã‚¬ã‚¤ãƒ‰" },
        ].map((v) => (
          <button key={v.k} onClick={() => setView(v.k)} style={{ padding: "10px 18px", borderRadius: 10, border: "none", cursor: "pointer", fontSize: 14, fontWeight: view === v.k ? 700 : 400, background: view === v.k ? "#1a2d4a" : "#e8e8e8", color: view === v.k ? "#fff" : "#555" }}>
            {v.l}
          </button>
        ))}
      </div>

      {view === "dashboard" && (
        <div style={{ display: "grid", gridTemplateColumns: isMobile ? "repeat(2,1fr)" : "repeat(auto-fit,minmax(160px,1fr))", gap: 14, marginBottom: 20 }}>
          {[
            ["ğŸ“Š", "ç·å—é¨“å›æ•°", results.length],
            ["ğŸ‘¤", "å—é¨“è€…æ•°", uniq.length + "å"],
            ["âœ…", "åˆæ ¼æ•°", passC],
            ["ğŸ“ˆ", "åˆæ ¼ç‡", results.length ? Math.round((passC / results.length) * 100) + "%" : "-%"],
          ].map(([ic, l, v]) => (
            <div key={l} style={{ ...S.card, padding: 20 }}>
              <div style={{ fontSize: 24, marginBottom: 6 }}>{ic}</div>
              <div style={{ fontSize: 13, color: "#888" }}>{l}</div>
              <div style={{ fontSize: 24, fontWeight: 700, color: "#1a2d4a", marginTop: 4 }}>{v}</div>
            </div>
          ))}
        </div>
      )}

      {view === "results" && (
        <div style={S.card}>
          <div style={{ padding: "16px 20px", borderBottom: "1px solid #e0e0e0", fontSize: 16, fontWeight: 700, color: "#1a2d4a" }}>å…¨å—é¨“å±¥æ­´</div>
          {results.length === 0 ? (
            <div style={{ padding: 30, textAlign: "center", color: "#aaa", fontSize: 15 }}>ã¾ã å—é¨“ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>
          ) : (
            <div style={{ overflowX: "auto" }}>
              <table style={{ width: "100%", borderCollapse: "collapse", fontSize: isMobile ? 13 : 14, minWidth: 600 }}>
                <thead>
                  <tr style={{ background: "#f8f9fa" }}>
                    {["æ—¥æ™‚", "ç¤¾å“¡ç•ªå·", "æ°å", "ã‚³ãƒ¼ã‚¹", "ã‚¹ã‚³ã‚¢", "çµæœ"].map((h) => (
                      <th key={h} style={{ padding: "12px 14px", textAlign: "left", fontWeight: 600, color: "#555", whiteSpace: "nowrap" }}>{h}</th>
                    ))}
                  </tr>
                </thead>
                <tbody>
                  {results.map((r, i) => (
                    <tr key={i} style={{ borderBottom: "1px solid #f0f0f0" }}>
                      <td style={{ padding: "12px 14px", whiteSpace: "nowrap" }}>{fmt(r.date)}</td>
                      <td style={{ padding: "12px 14px" }}>{r.empId}</td>
                      <td style={{ padding: "12px 14px" }}>{r.name}</td>
                      <td style={{ padding: "12px 14px" }}>{r.courseName || r.courseId}</td>
                      <td style={{ padding: "12px 14px" }}>{r.score}/{r.totalQ}ï¼ˆ{r.pct}%ï¼‰</td>
                      <td style={{ padding: "12px 14px" }}>
                        <span style={{ background: r.passed ? "#d4edda" : "#f8d7da", color: r.passed ? "#155724" : "#721c24", padding: "4px 10px", borderRadius: 10, fontSize: 13, fontWeight: 600 }}>
                          {r.passed ? "åˆæ ¼" : "ä¸åˆæ ¼"}
                        </span>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>
      )}

      {view === "answers" && (
        <div style={S.card}>
          <div style={{ padding: "16px 20px", borderBottom: "1px solid #e0e0e0", fontSize: 16, fontWeight: 700, color: "#1a2d4a" }}>ğŸ“ å›ç­”é›†ã€ç®¡ç†è€…ç”¨ã€‘</div>
          <div style={{ background: "#fff3cd", padding: "12px 20px", fontSize: 14, color: "#856404", borderBottom: "1px solid #ffc107" }}>
            âš  æœ¬è³‡æ–™ã¯ç®¡ç†è€…ãƒ»æ•™è‚²æ‹…å½“è€…ç”¨ã§ã™ã€‚ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã«ã¯é…å¸ƒã—ãªã„ã§ãã ã•ã„ã€‚
          </div>
          <div style={{ display: "flex", borderBottom: "1px solid #eee", overflowX: "auto", scrollbarWidth: "none" }}>
            {ANSWER_SHEETS.map((s, i) => (
              <button key={i} onClick={() => setAnsSec(i)} style={{ background: "none", border: "none", padding: "14px 18px", cursor: "pointer", fontSize: 14, fontWeight: ansSec === i ? 700 : 400, color: ansSec === i ? "#922B21" : "#666", borderBottom: ansSec === i ? "3px solid #922B21" : "3px solid transparent", whiteSpace: "nowrap" }}>
                {s.title}
              </button>
            ))}
          </div>
          <div style={{ padding: "24px", whiteSpace: "pre-line", fontSize: 16, lineHeight: 2.2, color: "#333" }}>{ANSWER_SHEETS[ansSec].content}</div>
        </div>
      )}

      {view === "guide" && (
        <div style={S.card}>
          <div style={{ padding: "16px 20px", borderBottom: "1px solid #e0e0e0", fontSize: 16, fontWeight: 700, color: "#1a2d4a" }}>ğŸ“ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¤‰æ›´ã‚¬ã‚¤ãƒ‰</div>
          <div style={{ padding: "24px", fontSize: 16, lineHeight: 2.2, color: "#333" }}>
            <p style={{ fontWeight: 700, color: "#C0392B", marginBottom: 14 }}>æ‰‹é †æ›¸ãƒ»Eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®å†…å®¹å¤‰æ›´ãŒå¿…è¦ãªå ´åˆï¼š</p>
            <p>Claudeã«æŒ‡ç¤ºã™ã‚‹ã“ã¨ã§å¤‰æ›´ã§ãã¾ã™ã€‚</p>
            <div style={{ background: "#f8f9fa", borderRadius: 10, padding: "18px 20px", marginTop: 14, lineHeight: 2 }}>
              å¤‰æ›´ä¾é ¼ã®ä¾‹ï¼š<br />
              â€¢ ã€Œç´å…¥æ‰‹é †æ›¸ã®â—‹â—‹ã‚’è¿½åŠ ã—ã¦ã€<br />
              â€¢ ã€Œãƒ†ã‚¹ãƒˆå•é¡Œã‚’â–³â–³ã«å¤‰æ›´ã—ã¦ã€<br />
              â€¢ ã€ŒAIãƒãƒ£ãƒƒãƒˆã®çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«â–¡â–¡ã‚’è¿½åŠ ã€<br />
              â€¢ ã€Œæ³•ä»¤æ”¹æ­£ã«ä¼´ã„æ•°å€¤ã‚’æ›´æ–°ã€
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

/* ===== App ===== */
export default function App() {
  const [tab, setTab] = useState("home");
  const [user, setUser] = useState(null);

  useEffect(() => {
    try {
      const s = sessionStorage.getItem("meeks_user");
      if (s) setUser(JSON.parse(s));
    } catch {}
  }, []);

  const handleLogin = (u) => {
    setUser(u);
    try { sessionStorage.setItem("meeks_user", JSON.stringify(u)); } catch {}
  };
  const handleLogout = () => {
    setUser(null);
    setTab("home");
    try { sessionStorage.removeItem("meeks_user"); } catch {}
  };

  if (!user) return <Login onLogin={handleLogin} />;

  return (
    <div style={{ minHeight: "100vh", background: S.bg, fontFamily: "'Helvetica Neue',Arial,'Hiragino Sans','Noto Sans JP',sans-serif" }}>
      <Header tab={tab} setTab={(t) => { setTab(t); window.scrollTo(0, 0); }} user={user} onLogout={handleLogout} />
      <main style={{ minHeight: "calc(100vh - 80px)" }}>
        {tab === "home" && <Home setTab={setTab} user={user} />}
        {tab === "manual" && <ManualViewer />}
        {tab === "elearning" && <ELearning user={user} />}
        {tab === "chat" && <Chatbot />}
        {tab === "admin" && <AdminPanel />}
      </main>
    </div>
  );
}